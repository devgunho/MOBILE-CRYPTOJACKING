<!DOCTYPE html>
<html lang="en">
<head>
        <title>The Linux Kernel Archives</title>
        <meta charset="utf-8" />
	<link rel="icon" type="image/png" href="./theme/images/logos/favicon.png" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
                <link href="https://www.kernel.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The Linux Kernel Archives Atom Feed" />
                
        <link href="https://www.kernel.org/feeds/kdist.xml" type="application/atom+xml" rel="alternate" title="Latest Linux Kernel Releases" />

        <!--[if IE]>
                <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
	        <div id="tux-gear"></div>
                <h1><a href="./">The Linux Kernel Archives </a></h1>
                <nav><ul>
                                                                                                    <li ><a href="./category/about.html">About</a></li>
                                    <li ><a href="./category/contact-us.html">Contact us</a></li>
                                    <li ><a href="./category/faq.html">FAQ</a></li>
                                    <li ><a href="./category/releases.html">Releases</a></li>
                                    <li ><a href="./category/signatures.html">Signatures</a></li>
                                    <li ><a href="./category/site-news.html">Site news</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
    <aside id="featured" class="body">
    <article>
        <table id="protocols">
        <tr>
          <th>Protocol</th>
          <th>Location</th>
        </tr>
        <tr>
          <td><a href="https://www.ietf.org/rfc/rfc2616.txt">HTTP</a></td>
          <td><a href="https://www.kernel.org/pub/">https://www.kernel.org/pub/</a></td>
        </tr>

        <tr>
          <td><a href="https://git-scm.com/">GIT</a></td>
          <td><a href="https://git.kernel.org/">https://git.kernel.org/</a></td>
        </tr>

        <tr>
            <td><a href="https://rsync.samba.org/">RSYNC</a></td>
            <td>rsync://rsync.kernel.org/pub/</td>
        </tr>
        </table>

        <table id="latest">
        <tr>
            <td colspan="2" id="latest_label">
                <strong>Latest Stable Kernel:</strong>
            </td>
        </tr>
        <tr>
            <td id="latest_button">
                <a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.0.6.tar.xz"><img src="./theme/images/icons/downloadarrow_small.png" width="48" height="48" border="0" alt="Download"/></a>
            </td>
            <td id="latest_link">
                <a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.0.6.tar.xz">5.0.6</a>
            </td>
        </tr>
        </table>

        <table id="releases">
                <tr align="left">
            <td>mainline:</td>
            <td><strong>5.1-rc3</strong></td>
            <td>2019-03-31</td>
            <td>[<a href="https://git.kernel.org/torvalds/t/linux-5.1-rc3.tar.gz" title="Download complete tarball">tarball</a>] </td>
            <td> </td>
            <td>[<a href="https://git.kernel.org/torvalds/p/v5.1-rc3/v5.0" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://git.kernel.org/torvalds/p/v5.1-rc3/v5.1-rc2" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/torvalds/ds/v5.1-rc3/v5.1-rc2" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/torvalds/h/v5.1-rc3" title="Browse the git tree using cgit">browse</a>]  </td>
            <td> </td>
        </tr>
                <tr align="left">
            <td>stable:</td>
            <td><strong>5.0.6</strong></td>
            <td>2019-04-03</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.0.6.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.0.6.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/patch-5.0.6.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/incr/patch-5.0.5-6.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v5.0.6/v5.0.5" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v5.0.6" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.6" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>stable:</td>
            <td><strong>4.20.17 <span class="eolkernel" title="This release is End-of-Life">[EOL]</span></strong></td>
            <td>2019-03-19</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.20.17.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.20.17.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/patch-4.20.17.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/incr/patch-4.20.16-17.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v4.20.17/v4.20.16" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v4.20.17" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.20.17" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>longterm:</td>
            <td><strong>4.19.33</strong></td>
            <td>2019-04-03</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.19.33.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.19.33.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/patch-4.19.33.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/incr/patch-4.19.32-33.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v4.19.33/v4.19.32" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v4.19.33" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.19.33" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>longterm:</td>
            <td><strong>4.14.110</strong></td>
            <td>2019-04-03</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.14.110.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.14.110.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/patch-4.14.110.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/incr/patch-4.14.109-110.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v4.14.110/v4.14.109" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v4.14.110" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.14.110" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>longterm:</td>
            <td><strong>4.9.167</strong></td>
            <td>2019-04-03</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.9.167.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.9.167.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/patch-4.9.167.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/incr/patch-4.9.166-167.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v4.9.167/v4.9.166" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v4.9.167" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.9.167" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>longterm:</td>
            <td><strong>4.4.178</strong></td>
            <td>2019-04-03</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.4.178.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.4.178.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/patch-4.4.178.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/incr/patch-4.4.177-178.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v4.4.178/v4.4.177" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v4.4.178" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.4.178" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>longterm:</td>
            <td><strong>3.18.138 <span class="eolkernel" title="This release is End-of-Life">[EOL]</span></strong></td>
            <td>2019-04-03</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/linux-3.18.138.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/linux-3.18.138.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/patch-3.18.138.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/incr/patch-3.18.137-138.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v3.18.138/v3.18.137" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v3.18.138" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.18.138" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>longterm:</td>
            <td><strong>3.16.64</strong></td>
            <td>2019-03-25</td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/linux-3.16.64.tar.xz" title="Download complete tarball">tarball</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/linux-3.16.64.tar.sign" title="Download PGP verification signature">pgp</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/patch-3.16.64.xz" title="Download patch to previous mainline">patch</a>] </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/incr/patch-3.16.63-64.xz" title="Download incremental patch">inc.&nbsp;patch</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/ds/v3.16.64/v3.16.63" title="View diff in cgit">view&nbsp;diff</a>] </td>
            <td>[<a href="https://git.kernel.org/stable/h/v3.16.64" title="Browse the git tree using cgit">browse</a>]  </td>
            <td>[<a href="https://cdn.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.16.64" title="View detailed change logs">changelog</a>] </td>
        </tr>
                <tr align="left">
            <td>linux-next:</td>
            <td><strong>next-20190404</strong></td>
            <td>2019-04-04</td>
            <td> </td>
            <td> </td>
            <td> </td>
            <td> </td>
            <td> </td>
            <td>[<a href="https://git.kernel.org/next/linux-next/h/next-20190404" title="Browse the git tree using cgit">browse</a>]  </td>
            <td> </td>
        </tr>
                </table>
    </article>
</aside>
        <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>Other resources</h2>
                        <ul>
                                                    <li><a href="https://git.kernel.org/">Cgit</a></li>
                                                    <li><a href="https://www.kernel.org/doc/html/latest/">Documentation</a></li>
                                                    <li><a href="https://www.wiki.kernel.org/">Wikis</a></li>
                                                    <li><a href="https://bugzilla.kernel.org/">Bugzilla</a></li>
                                                    <li><a href="https://patchwork.kernel.org/">Patchwork</a></li>
                                                    <li><a href="http://vger.kernel.org/">Kernel Mailing Lists</a></li>
                                                    <li><a href="https://mirrors.kernel.org/">Mirrors</a></li>
                                                    <li><a href="https://www.linux.com/">Linux.com</a></li>
                                                    <li><a href="http://www.linuxfoundation.org/">Linux Foundation</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>Social</h2>
                        <ul>
                            <li><a href="https://www.kernel.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Site Atom feed</a></li>
                                                        <li><a href="https://www.kernel.org/feeds/kdist.xml" type="application/atom+xml" rel="alternate">Releases Atom Feed</a></li>

                                                    <li><a href="http://planet.kernel.org/">Kernel Planet</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                    This site is operated by the Linux Kernel Organization, Inc., a <a href="./nonprofit.html">501(c)3 nonprofit corporation</a>, with support from the following sponsors.
                </address><!-- /#about -->

                <address id="donors">
                  <a href="https://www.redhat.com/"><img src="./theme/images/logos/redhat-logo.png"
                  alt="Red Hat" height="36" width="108" /></a>
                  &nbsp;
                  <a href="https://www.packet.com/"><img src="./theme/images/logos/packet.png"
                  alt="Packet" height="39" width="106" /></a>
                  &nbsp;
                  <a href="https://www.fastly.com/"><img src="./theme/images/logos/fastly-logo.png"
                  alt="Fastly" width="91" height="35" /></a>
                  &nbsp;
                  <a href="https://www.google.com/"><img src="./theme/images/logos/google.png"
                  alt="Google" height="42" width="128" /></a>
                  <br/>
                  <a href="https://www.constellix.com/"><img src="./theme/images/logos/constellix-green-logo.png"
                  alt="Constellix" width="193" height="21" style="vertical-align: bottom; padding-bottom: 4px" /></a>
                  &nbsp;
                  <a href="https://www.purestorage.com/"><img src="./theme/images/logos/purestorage.png"
                  alt="PureStorage" width="179" height="45" /></a>
                  <br/>&nbsp;<br/>
                  <a href="https://www.linuxfoundation.org/"><img src="./theme/images/logos/thelinuxfoundation.png"
                  alt="The Linux Foundation" width="137" height="45" /></a>
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

</body>
</html>


#####EOF#####


<!DOCTYPE html>
<html lang='en'>
<head>
<title>kernel/git/torvalds/linux.git - Linux kernel source tree</title>
<meta name='generator' content='cgit 1.2-0.3.lf.el7'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='http://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/torvalds/linux.git' title='kernel/git/torvalds/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a title='kernel/git/torvalds/linux.git' href='/pub/scm/linux/kernel/git/torvalds/linux.git/'>kernel/git/torvalds/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='059c2a4d8e164dccc3078e49e7f286023b019a98'/><select name='h' onchange='this.form.submit();'>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel source tree</td><td class='sub right'>Linus Torvalds</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>refs</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>commit</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>diff</a><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/torvalds/linux.git/log/'>
<input type='hidden' name='id' value='059c2a4d8e164dccc3078e49e7f286023b019a98'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='059c2a4d8e164dccc3078e49e7f286023b019a98'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td><span class='libravatar'><img class='inline' src='//seccdn.libravatar.org/avatar/a115d165abc47f88e8112f94bc25b6bd?s=13&amp;d=retro' /><img class='onhover' src='//seccdn.libravatar.org/avatar/a115d165abc47f88e8112f94bc25b6bd?s=128&amp;d=retro' /></span>Eric Biggers &lt;ebiggers@google.com&gt;</td><td class='right'>2018-11-16 17:26:31 -0800</td></tr>
<tr><th>committer</th><td><span class='libravatar'><img class='inline' src='//seccdn.libravatar.org/avatar/07350b82f72e75c542d26b756f5bb085?s=13&amp;d=retro' /><img class='onhover' src='//seccdn.libravatar.org/avatar/07350b82f72e75c542d26b756f5bb085?s=128&amp;d=retro' /></span>Herbert Xu &lt;herbert@gondor.apana.org.au&gt;</td><td class='right'>2018-11-20 14:26:56 +0800</td></tr>
<tr><th>commit</th><td colspan='2' class='sha1'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>059c2a4d8e164dccc3078e49e7f286023b019a98</a> (<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='sha1'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>1848d90f72c8c531ed3fe9793cabcb8a04c490b3</a></td></tr>
<tr><th>parent</th><td colspan='2' class='sha1'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=16aae3595a9d41c97d983889b341c455779c2ecf'>16aae3595a9d41c97d983889b341c455779c2ecf</a> (<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=059c2a4d8e164dccc3078e49e7f286023b019a98&amp;id2=16aae3595a9d41c97d983889b341c455779c2ecf'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='sha1'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-059c2a4d8e164dccc3078e49e7f286023b019a98.tar.gz'>linux-059c2a4d8e164dccc3078e49e7f286023b019a98.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>crypto: adiantum - add Adiantum support</div><div class='commit-msg'>Add support for the Adiantum encryption mode.  Adiantum was designed by
Paul Crowley and is specified by our paper:

    Adiantum: length-preserving encryption for entry-level processors
    (https://eprint.iacr.org/2018/720.pdf)

See our paper for full details; this patch only provides an overview.

Adiantum is a tweakable, length-preserving encryption mode designed for
fast and secure disk encryption, especially on CPUs without dedicated
crypto instructions.  Adiantum encrypts each sector using the XChaCha12
stream cipher, two passes of an Îµ-almost-â-universal (ÎµAâU) hash
function, and an invocation of the AES-256 block cipher on a single
16-byte block.  On CPUs without AES instructions, Adiantum is much
faster than AES-XTS; for example, on ARM Cortex-A7, on 4096-byte sectors
Adiantum encryption is about 4 times faster than AES-256-XTS encryption,
and decryption about 5 times faster.

Adiantum is a specialization of the more general HBSH construction.  Our
earlier proposal, HPolyC, was also a HBSH specialization, but it used a
different ÎµAâU hash function, one based on Poly1305 only.  Adiantum's
ÎµAâU hash function, which is based primarily on the "NH" hash function
like that used in UMAC (RFC4418), is about twice as fast as HPolyC's;
consequently, Adiantum is about 20% faster than HPolyC.

This speed comes with no loss of security: Adiantum is provably just as
secure as HPolyC, in fact slightly *more* secure.  Like HPolyC,
Adiantum's security is reducible to that of XChaCha12 and AES-256,
subject to a security bound.  XChaCha12 itself has a security reduction
to ChaCha12.  Therefore, one need not "trust" Adiantum; one need only
trust ChaCha12 and AES-256.  Note that the ÎµAâU hash function is only
used for its proven combinatorical properties so cannot be "broken".

Adiantum is also a true wide-block encryption mode, so flipping any
plaintext bit in the sector scrambles the entire ciphertext, and vice
versa.  No other such mode is available in the kernel currently; doing
the same with XTS scrambles only 16 bytes.  Adiantum also supports
arbitrary-length tweaks and naturally supports any length input &gt;= 16
bytes without needing "ciphertext stealing".

For the stream cipher, Adiantum uses XChaCha12 rather than XChaCha20 in
order to make encryption feasible on the widest range of devices.
Although the 20-round variant is quite popular, the best known attacks
on ChaCha are on only 7 rounds, so ChaCha12 still has a substantial
security margin; in fact, larger than AES-256's.  12-round Salsa20 is
also the eSTREAM recommendation.  For the block cipher, Adiantum uses
AES-256, despite it having a lower security margin than XChaCha12 and
needing table lookups, due to AES's extensive adoption and analysis
making it the obvious first choice.  Nevertheless, for flexibility this
patch also permits the "adiantum" template to be instantiated with
XChaCha20 and/or with an alternate block cipher.

We need Adiantum support in the kernel for use in dm-crypt and fscrypt,
where currently the only other suitable options are block cipher modes
such as AES-XTS.  A big problem with this is that many low-end mobile
devices (e.g. Android Go phones sold primarily in developing countries,
as well as some smartwatches) still have CPUs that lack AES
instructions, e.g. ARM Cortex-A7.  Sadly, AES-XTS encryption is much too
slow to be viable on these devices.  We did find that some "lightweight"
block ciphers are fast enough, but these suffer from problems such as
not having much cryptanalysis or being too controversial.

The ChaCha stream cipher has excellent performance but is insecure to
use directly for disk encryption, since each sector's IV is reused each
time it is overwritten.  Even restricting the threat model to offline
attacks only isn't enough, since modern flash storage devices don't
guarantee that "overwrites" are really overwrites, due to wear-leveling.
Adiantum avoids this problem by constructing a
"tweakable super-pseudorandom permutation"; this is the strongest
possible security model for length-preserving encryption.

Of course, storing random nonces along with the ciphertext would be the
ideal solution.  But doing that with existing hardware and filesystems
runs into major practical problems; in most cases it would require data
journaling (like dm-integrity) which severely degrades performance.
Thus, for now length-preserving encryption is still needed.

Signed-off-by: Eric Biggers &lt;ebiggers@google.com&gt;
Reviewed-by: Ard Biesheuvel &lt;ard.biesheuvel@linaro.org&gt;
Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/crypto/Kconfig?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/Kconfig</a></td><td class='right'>23</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 3.5%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 96.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/crypto/Makefile?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/Makefile</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 0.2%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='add'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/crypto/adiantum.c?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/adiantum.c</a></td><td class='right'>658</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 100.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/crypto/tcrypt.c?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/tcrypt.c</a></td><td class='right'>12</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.8%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 98.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/crypto/testmgr.c?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/testmgr.c</a></td><td class='right'>12</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.8%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 98.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/torvalds/linux.git/diff/crypto/testmgr.h?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/testmgr.h</a></td><td class='right'>461</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 70.1%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 29.9%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>6 files changed, 1167 insertions, 0 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/crypto/Kconfig b/crypto/Kconfig<br/>index eaeb8a986b7d..b6376d5d973e 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/Kconfig?id=16aae3595a9d41c97d983889b341c455779c2ecf'>crypto/Kconfig</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/Kconfig?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/Kconfig</a></div><div class='hunk'>@@ -501,6 +501,29 @@ config CRYPTO_NHPOLY1305</div><div class='ctx'> 	select CRYPTO_HASH</div><div class='ctx'> 	select CRYPTO_POLY1305</div><div class='ctx'> </div><div class='add'>+config CRYPTO_ADIANTUM</div><div class='add'>+	tristate "Adiantum support"</div><div class='add'>+	select CRYPTO_CHACHA20</div><div class='add'>+	select CRYPTO_POLY1305</div><div class='add'>+	select CRYPTO_NHPOLY1305</div><div class='add'>+	help</div><div class='add'>+	  Adiantum is a tweakable, length-preserving encryption mode</div><div class='add'>+	  designed for fast and secure disk encryption, especially on</div><div class='add'>+	  CPUs without dedicated crypto instructions.  It encrypts</div><div class='add'>+	  each sector using the XChaCha12 stream cipher, two passes of</div><div class='add'>+	  an Îµ-almost-â-universal hash function, and an invocation of</div><div class='add'>+	  the AES-256 block cipher on a single 16-byte block.  On CPUs</div><div class='add'>+	  without AES instructions, Adiantum is much faster than</div><div class='add'>+	  AES-XTS.</div><div class='add'>+</div><div class='add'>+	  Adiantum's security is provably reducible to that of its</div><div class='add'>+	  underlying stream and block ciphers, subject to a security</div><div class='add'>+	  bound.  Unlike XTS, Adiantum is a true wide-block encryption</div><div class='add'>+	  mode, so it actually provides an even stronger notion of</div><div class='add'>+	  security than XTS, subject to the security bound.</div><div class='add'>+</div><div class='add'>+	  If unsure, say N.</div><div class='add'>+</div><div class='ctx'> comment "Hash modes"</div><div class='ctx'> </div><div class='ctx'> config CRYPTO_CMAC</div><div class='head'>diff --git a/crypto/Makefile b/crypto/Makefile<br/>index c3310c85f09f..5e789dc2d4fd 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/Makefile?id=16aae3595a9d41c97d983889b341c455779c2ecf'>crypto/Makefile</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/Makefile?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/Makefile</a></div><div class='hunk'>@@ -85,6 +85,7 @@ obj-$(CONFIG_CRYPTO_LRW) += lrw.o</div><div class='ctx'> obj-$(CONFIG_CRYPTO_XTS) += xts.o</div><div class='ctx'> obj-$(CONFIG_CRYPTO_CTR) += ctr.o</div><div class='ctx'> obj-$(CONFIG_CRYPTO_KEYWRAP) += keywrap.o</div><div class='add'>+obj-$(CONFIG_CRYPTO_ADIANTUM) += adiantum.o</div><div class='ctx'> obj-$(CONFIG_CRYPTO_NHPOLY1305) += nhpoly1305.o</div><div class='ctx'> obj-$(CONFIG_CRYPTO_GCM) += gcm.o</div><div class='ctx'> obj-$(CONFIG_CRYPTO_CCM) += ccm.o</div><div class='head'>diff --git a/crypto/adiantum.c b/crypto/adiantum.c<br/>new file mode 100644<br/>index 000000000000..2dfcf12fd452<br/>--- /dev/null<br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/adiantum.c?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/adiantum.c</a></div><div class='hunk'>@@ -0,0 +1,658 @@</div><div class='add'>+// SPDX-License-Identifier: GPL-2.0</div><div class='add'>+/*</div><div class='add'>+ * Adiantum length-preserving encryption mode</div><div class='add'>+ *</div><div class='add'>+ * Copyright 2018 Google LLC</div><div class='add'>+ */</div><div class='add'>+</div><div class='add'>+/*</div><div class='add'>+ * Adiantum is a tweakable, length-preserving encryption mode designed for fast</div><div class='add'>+ * and secure disk encryption, especially on CPUs without dedicated crypto</div><div class='add'>+ * instructions.  Adiantum encrypts each sector using the XChaCha12 stream</div><div class='add'>+ * cipher, two passes of an Îµ-almost-â-universal (ÎµAâU) hash function based on</div><div class='add'>+ * NH and Poly1305, and an invocation of the AES-256 block cipher on a single</div><div class='add'>+ * 16-byte block.  See the paper for details:</div><div class='add'>+ *</div><div class='add'>+ *	Adiantum: length-preserving encryption for entry-level processors</div><div class='add'>+ *      (https://eprint.iacr.org/2018/720.pdf)</div><div class='add'>+ *</div><div class='add'>+ * For flexibility, this implementation also allows other ciphers:</div><div class='add'>+ *</div><div class='add'>+ *	- Stream cipher: XChaCha12 or XChaCha20</div><div class='add'>+ *	- Block cipher: any with a 128-bit block size and 256-bit key</div><div class='add'>+ *</div><div class='add'>+ * This implementation doesn't currently allow other ÎµAâU hash functions, i.e.</div><div class='add'>+ * HPolyC is not supported.  This is because Adiantum is ~20% faster than HPolyC</div><div class='add'>+ * but still provably as secure, and also the ÎµAâU hash function of HBSH is</div><div class='add'>+ * formally defined to take two inputs (tweak, message) which makes it difficult</div><div class='add'>+ * to wrap with the crypto_shash API.  Rather, some details need to be handled</div><div class='add'>+ * here.  Nevertheless, if needed in the future, support for other ÎµAâU hash</div><div class='add'>+ * functions could be added here.</div><div class='add'>+ */</div><div class='add'>+</div><div class='add'>+#include &lt;crypto/b128ops.h&gt;</div><div class='add'>+#include &lt;crypto/chacha.h&gt;</div><div class='add'>+#include &lt;crypto/internal/hash.h&gt;</div><div class='add'>+#include &lt;crypto/internal/skcipher.h&gt;</div><div class='add'>+#include &lt;crypto/nhpoly1305.h&gt;</div><div class='add'>+#include &lt;crypto/scatterwalk.h&gt;</div><div class='add'>+#include &lt;linux/module.h&gt;</div><div class='add'>+</div><div class='add'>+#include "internal.h"</div><div class='add'>+</div><div class='add'>+/*</div><div class='add'>+ * Size of right-hand block of input data, in bytes; also the size of the block</div><div class='add'>+ * cipher's block size and the hash function's output.</div><div class='add'>+ */</div><div class='add'>+#define BLOCKCIPHER_BLOCK_SIZE		16</div><div class='add'>+</div><div class='add'>+/* Size of the block cipher key (K_E) in bytes */</div><div class='add'>+#define BLOCKCIPHER_KEY_SIZE		32</div><div class='add'>+</div><div class='add'>+/* Size of the hash key (K_H) in bytes */</div><div class='add'>+#define HASH_KEY_SIZE		(POLY1305_BLOCK_SIZE + NHPOLY1305_KEY_SIZE)</div><div class='add'>+</div><div class='add'>+/*</div><div class='add'>+ * The specification allows variable-length tweaks, but Linux's crypto API</div><div class='add'>+ * currently only allows algorithms to support a single length.  The "natural"</div><div class='add'>+ * tweak length for Adiantum is 16, since that fits into one Poly1305 block for</div><div class='add'>+ * the best performance.  But longer tweaks are useful for fscrypt, to avoid</div><div class='add'>+ * needing to derive per-file keys.  So instead we use two blocks, or 32 bytes.</div><div class='add'>+ */</div><div class='add'>+#define TWEAK_SIZE		32</div><div class='add'>+</div><div class='add'>+struct adiantum_instance_ctx {</div><div class='add'>+	struct crypto_skcipher_spawn streamcipher_spawn;</div><div class='add'>+	struct crypto_spawn blockcipher_spawn;</div><div class='add'>+	struct crypto_shash_spawn hash_spawn;</div><div class='add'>+};</div><div class='add'>+</div><div class='add'>+struct adiantum_tfm_ctx {</div><div class='add'>+	struct crypto_skcipher *streamcipher;</div><div class='add'>+	struct crypto_cipher *blockcipher;</div><div class='add'>+	struct crypto_shash *hash;</div><div class='add'>+	struct poly1305_key header_hash_key;</div><div class='add'>+};</div><div class='add'>+</div><div class='add'>+struct adiantum_request_ctx {</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * Buffer for right-hand block of data, i.e.</div><div class='add'>+	 *</div><div class='add'>+	 *    P_L =&gt; P_M =&gt; C_M =&gt; C_R when encrypting, or</div><div class='add'>+	 *    C_R =&gt; C_M =&gt; P_M =&gt; P_L when decrypting.</div><div class='add'>+	 *</div><div class='add'>+	 * Also used to build the IV for the stream cipher.</div><div class='add'>+	 */</div><div class='add'>+	union {</div><div class='add'>+		u8 bytes[XCHACHA_IV_SIZE];</div><div class='add'>+		__le32 words[XCHACHA_IV_SIZE / sizeof(__le32)];</div><div class='add'>+		le128 bignum;	/* interpret as element of Z/(2^{128}Z) */</div><div class='add'>+	} rbuf;</div><div class='add'>+</div><div class='add'>+	bool enc; /* true if encrypting, false if decrypting */</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * The result of the Poly1305 ÎµAâU hash function applied to</div><div class='add'>+	 * (message length, tweak).</div><div class='add'>+	 */</div><div class='add'>+	le128 header_hash;</div><div class='add'>+</div><div class='add'>+	/* Sub-requests, must be last */</div><div class='add'>+	union {</div><div class='add'>+		struct shash_desc hash_desc;</div><div class='add'>+		struct skcipher_request streamcipher_req;</div><div class='add'>+	} u;</div><div class='add'>+};</div><div class='add'>+</div><div class='add'>+/*</div><div class='add'>+ * Given the XChaCha stream key K_S, derive the block cipher key K_E and the</div><div class='add'>+ * hash key K_H as follows:</div><div class='add'>+ *</div><div class='add'>+ *     K_E || K_H || ... = XChaCha(key=K_S, nonce=1||0^191)</div><div class='add'>+ *</div><div class='add'>+ * Note that this denotes using bits from the XChaCha keystream, which here we</div><div class='add'>+ * get indirectly by encrypting a buffer containing all 0's.</div><div class='add'>+ */</div><div class='add'>+static int adiantum_setkey(struct crypto_skcipher *tfm, const u8 *key,</div><div class='add'>+			   unsigned int keylen)</div><div class='add'>+{</div><div class='add'>+	struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+	struct {</div><div class='add'>+		u8 iv[XCHACHA_IV_SIZE];</div><div class='add'>+		u8 derived_keys[BLOCKCIPHER_KEY_SIZE + HASH_KEY_SIZE];</div><div class='add'>+		struct scatterlist sg;</div><div class='add'>+		struct crypto_wait wait;</div><div class='add'>+		struct skcipher_request req; /* must be last */</div><div class='add'>+	} *data;</div><div class='add'>+	u8 *keyp;</div><div class='add'>+	int err;</div><div class='add'>+</div><div class='add'>+	/* Set the stream cipher key (K_S) */</div><div class='add'>+	crypto_skcipher_clear_flags(tctx-&gt;streamcipher, CRYPTO_TFM_REQ_MASK);</div><div class='add'>+	crypto_skcipher_set_flags(tctx-&gt;streamcipher,</div><div class='add'>+				  crypto_skcipher_get_flags(tfm) &amp;</div><div class='add'>+				  CRYPTO_TFM_REQ_MASK);</div><div class='add'>+	err = crypto_skcipher_setkey(tctx-&gt;streamcipher, key, keylen);</div><div class='add'>+	crypto_skcipher_set_flags(tfm,</div><div class='add'>+				crypto_skcipher_get_flags(tctx-&gt;streamcipher) &amp;</div><div class='add'>+				CRYPTO_TFM_RES_MASK);</div><div class='add'>+	if (err)</div><div class='add'>+		return err;</div><div class='add'>+</div><div class='add'>+	/* Derive the subkeys */</div><div class='add'>+	data = kzalloc(sizeof(*data) +</div><div class='add'>+		       crypto_skcipher_reqsize(tctx-&gt;streamcipher), GFP_KERNEL);</div><div class='add'>+	if (!data)</div><div class='add'>+		return -ENOMEM;</div><div class='add'>+	data-&gt;iv[0] = 1;</div><div class='add'>+	sg_init_one(&amp;data-&gt;sg, data-&gt;derived_keys, sizeof(data-&gt;derived_keys));</div><div class='add'>+	crypto_init_wait(&amp;data-&gt;wait);</div><div class='add'>+	skcipher_request_set_tfm(&amp;data-&gt;req, tctx-&gt;streamcipher);</div><div class='add'>+	skcipher_request_set_callback(&amp;data-&gt;req, CRYPTO_TFM_REQ_MAY_SLEEP |</div><div class='add'>+						  CRYPTO_TFM_REQ_MAY_BACKLOG,</div><div class='add'>+				      crypto_req_done, &amp;data-&gt;wait);</div><div class='add'>+	skcipher_request_set_crypt(&amp;data-&gt;req, &amp;data-&gt;sg, &amp;data-&gt;sg,</div><div class='add'>+				   sizeof(data-&gt;derived_keys), data-&gt;iv);</div><div class='add'>+	err = crypto_wait_req(crypto_skcipher_encrypt(&amp;data-&gt;req), &amp;data-&gt;wait);</div><div class='add'>+	if (err)</div><div class='add'>+		goto out;</div><div class='add'>+	keyp = data-&gt;derived_keys;</div><div class='add'>+</div><div class='add'>+	/* Set the block cipher key (K_E) */</div><div class='add'>+	crypto_cipher_clear_flags(tctx-&gt;blockcipher, CRYPTO_TFM_REQ_MASK);</div><div class='add'>+	crypto_cipher_set_flags(tctx-&gt;blockcipher,</div><div class='add'>+				crypto_skcipher_get_flags(tfm) &amp;</div><div class='add'>+				CRYPTO_TFM_REQ_MASK);</div><div class='add'>+	err = crypto_cipher_setkey(tctx-&gt;blockcipher, keyp,</div><div class='add'>+				   BLOCKCIPHER_KEY_SIZE);</div><div class='add'>+	crypto_skcipher_set_flags(tfm,</div><div class='add'>+				  crypto_cipher_get_flags(tctx-&gt;blockcipher) &amp;</div><div class='add'>+				  CRYPTO_TFM_RES_MASK);</div><div class='add'>+	if (err)</div><div class='add'>+		goto out;</div><div class='add'>+	keyp += BLOCKCIPHER_KEY_SIZE;</div><div class='add'>+</div><div class='add'>+	/* Set the hash key (K_H) */</div><div class='add'>+	poly1305_core_setkey(&amp;tctx-&gt;header_hash_key, keyp);</div><div class='add'>+	keyp += POLY1305_BLOCK_SIZE;</div><div class='add'>+</div><div class='add'>+	crypto_shash_clear_flags(tctx-&gt;hash, CRYPTO_TFM_REQ_MASK);</div><div class='add'>+	crypto_shash_set_flags(tctx-&gt;hash, crypto_skcipher_get_flags(tfm) &amp;</div><div class='add'>+					   CRYPTO_TFM_REQ_MASK);</div><div class='add'>+	err = crypto_shash_setkey(tctx-&gt;hash, keyp, NHPOLY1305_KEY_SIZE);</div><div class='add'>+	crypto_skcipher_set_flags(tfm, crypto_shash_get_flags(tctx-&gt;hash) &amp;</div><div class='add'>+				       CRYPTO_TFM_RES_MASK);</div><div class='add'>+	keyp += NHPOLY1305_KEY_SIZE;</div><div class='add'>+	WARN_ON(keyp != &amp;data-&gt;derived_keys[ARRAY_SIZE(data-&gt;derived_keys)]);</div><div class='add'>+out:</div><div class='add'>+	kzfree(data);</div><div class='add'>+	return err;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/* Addition in Z/(2^{128}Z) */</div><div class='add'>+static inline void le128_add(le128 *r, const le128 *v1, const le128 *v2)</div><div class='add'>+{</div><div class='add'>+	u64 x = le64_to_cpu(v1-&gt;b);</div><div class='add'>+	u64 y = le64_to_cpu(v2-&gt;b);</div><div class='add'>+</div><div class='add'>+	r-&gt;b = cpu_to_le64(x + y);</div><div class='add'>+	r-&gt;a = cpu_to_le64(le64_to_cpu(v1-&gt;a) + le64_to_cpu(v2-&gt;a) +</div><div class='add'>+			   (x + y &lt; x));</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/* Subtraction in Z/(2^{128}Z) */</div><div class='add'>+static inline void le128_sub(le128 *r, const le128 *v1, const le128 *v2)</div><div class='add'>+{</div><div class='add'>+	u64 x = le64_to_cpu(v1-&gt;b);</div><div class='add'>+	u64 y = le64_to_cpu(v2-&gt;b);</div><div class='add'>+</div><div class='add'>+	r-&gt;b = cpu_to_le64(x - y);</div><div class='add'>+	r-&gt;a = cpu_to_le64(le64_to_cpu(v1-&gt;a) - le64_to_cpu(v2-&gt;a) -</div><div class='add'>+			   (x - y &gt; x));</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/*</div><div class='add'>+ * Apply the Poly1305 ÎµAâU hash function to (message length, tweak) and save the</div><div class='add'>+ * result to rctx-&gt;header_hash.</div><div class='add'>+ *</div><div class='add'>+ * This value is reused in both the first and second hash steps.  Specifically,</div><div class='add'>+ * it's added to the result of an independently keyed ÎµAâU hash function (for</div><div class='add'>+ * equal length inputs only) taken over the message.  This gives the overall</div><div class='add'>+ * Adiantum hash of the (tweak, message) pair.</div><div class='add'>+ */</div><div class='add'>+static void adiantum_hash_header(struct skcipher_request *req)</div><div class='add'>+{</div><div class='add'>+	struct crypto_skcipher *tfm = crypto_skcipher_reqtfm(req);</div><div class='add'>+	const struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+	struct adiantum_request_ctx *rctx = skcipher_request_ctx(req);</div><div class='add'>+	const unsigned int bulk_len = req-&gt;cryptlen - BLOCKCIPHER_BLOCK_SIZE;</div><div class='add'>+	struct {</div><div class='add'>+		__le64 message_bits;</div><div class='add'>+		__le64 padding;</div><div class='add'>+	} header = {</div><div class='add'>+		.message_bits = cpu_to_le64((u64)bulk_len * 8)</div><div class='add'>+	};</div><div class='add'>+	struct poly1305_state state;</div><div class='add'>+</div><div class='add'>+	poly1305_core_init(&amp;state);</div><div class='add'>+</div><div class='add'>+	BUILD_BUG_ON(sizeof(header) % POLY1305_BLOCK_SIZE != 0);</div><div class='add'>+	poly1305_core_blocks(&amp;state, &amp;tctx-&gt;header_hash_key,</div><div class='add'>+			     &amp;header, sizeof(header) / POLY1305_BLOCK_SIZE);</div><div class='add'>+</div><div class='add'>+	BUILD_BUG_ON(TWEAK_SIZE % POLY1305_BLOCK_SIZE != 0);</div><div class='add'>+	poly1305_core_blocks(&amp;state, &amp;tctx-&gt;header_hash_key, req-&gt;iv,</div><div class='add'>+			     TWEAK_SIZE / POLY1305_BLOCK_SIZE);</div><div class='add'>+</div><div class='add'>+	poly1305_core_emit(&amp;state, &amp;rctx-&gt;header_hash);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/* Hash the left-hand block (the "bulk") of the message using NHPoly1305 */</div><div class='add'>+static int adiantum_hash_message(struct skcipher_request *req,</div><div class='add'>+				 struct scatterlist *sgl, le128 *digest)</div><div class='add'>+{</div><div class='add'>+	struct crypto_skcipher *tfm = crypto_skcipher_reqtfm(req);</div><div class='add'>+	const struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+	struct adiantum_request_ctx *rctx = skcipher_request_ctx(req);</div><div class='add'>+	const unsigned int bulk_len = req-&gt;cryptlen - BLOCKCIPHER_BLOCK_SIZE;</div><div class='add'>+	struct shash_desc *hash_desc = &amp;rctx-&gt;u.hash_desc;</div><div class='add'>+	struct sg_mapping_iter miter;</div><div class='add'>+	unsigned int i, n;</div><div class='add'>+	int err;</div><div class='add'>+</div><div class='add'>+	hash_desc-&gt;tfm = tctx-&gt;hash;</div><div class='add'>+	hash_desc-&gt;flags = 0;</div><div class='add'>+</div><div class='add'>+	err = crypto_shash_init(hash_desc);</div><div class='add'>+	if (err)</div><div class='add'>+		return err;</div><div class='add'>+</div><div class='add'>+	sg_miter_start(&amp;miter, sgl, sg_nents(sgl),</div><div class='add'>+		       SG_MITER_FROM_SG | SG_MITER_ATOMIC);</div><div class='add'>+	for (i = 0; i &lt; bulk_len; i += n) {</div><div class='add'>+		sg_miter_next(&amp;miter);</div><div class='add'>+		n = min_t(unsigned int, miter.length, bulk_len - i);</div><div class='add'>+		err = crypto_shash_update(hash_desc, miter.addr, n);</div><div class='add'>+		if (err)</div><div class='add'>+			break;</div><div class='add'>+	}</div><div class='add'>+	sg_miter_stop(&amp;miter);</div><div class='add'>+	if (err)</div><div class='add'>+		return err;</div><div class='add'>+</div><div class='add'>+	return crypto_shash_final(hash_desc, (u8 *)digest);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/* Continue Adiantum encryption/decryption after the stream cipher step */</div><div class='add'>+static int adiantum_finish(struct skcipher_request *req)</div><div class='add'>+{</div><div class='add'>+	struct crypto_skcipher *tfm = crypto_skcipher_reqtfm(req);</div><div class='add'>+	const struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+	struct adiantum_request_ctx *rctx = skcipher_request_ctx(req);</div><div class='add'>+	const unsigned int bulk_len = req-&gt;cryptlen - BLOCKCIPHER_BLOCK_SIZE;</div><div class='add'>+	le128 digest;</div><div class='add'>+	int err;</div><div class='add'>+</div><div class='add'>+	/* If decrypting, decrypt C_M with the block cipher to get P_M */</div><div class='add'>+	if (!rctx-&gt;enc)</div><div class='add'>+		crypto_cipher_decrypt_one(tctx-&gt;blockcipher, rctx-&gt;rbuf.bytes,</div><div class='add'>+					  rctx-&gt;rbuf.bytes);</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * Second hash step</div><div class='add'>+	 *	enc: C_R = C_M - H_{K_H}(T, C_L)</div><div class='add'>+	 *	dec: P_R = P_M - H_{K_H}(T, P_L)</div><div class='add'>+	 */</div><div class='add'>+	err = adiantum_hash_message(req, req-&gt;dst, &amp;digest);</div><div class='add'>+	if (err)</div><div class='add'>+		return err;</div><div class='add'>+	le128_add(&amp;digest, &amp;digest, &amp;rctx-&gt;header_hash);</div><div class='add'>+	le128_sub(&amp;rctx-&gt;rbuf.bignum, &amp;rctx-&gt;rbuf.bignum, &amp;digest);</div><div class='add'>+	scatterwalk_map_and_copy(&amp;rctx-&gt;rbuf.bignum, req-&gt;dst,</div><div class='add'>+				 bulk_len, BLOCKCIPHER_BLOCK_SIZE, 1);</div><div class='add'>+	return 0;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static void adiantum_streamcipher_done(struct crypto_async_request *areq,</div><div class='add'>+				       int err)</div><div class='add'>+{</div><div class='add'>+	struct skcipher_request *req = areq-&gt;data;</div><div class='add'>+</div><div class='add'>+	if (!err)</div><div class='add'>+		err = adiantum_finish(req);</div><div class='add'>+</div><div class='add'>+	skcipher_request_complete(req, err);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static int adiantum_crypt(struct skcipher_request *req, bool enc)</div><div class='add'>+{</div><div class='add'>+	struct crypto_skcipher *tfm = crypto_skcipher_reqtfm(req);</div><div class='add'>+	const struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+	struct adiantum_request_ctx *rctx = skcipher_request_ctx(req);</div><div class='add'>+	const unsigned int bulk_len = req-&gt;cryptlen - BLOCKCIPHER_BLOCK_SIZE;</div><div class='add'>+	unsigned int stream_len;</div><div class='add'>+	le128 digest;</div><div class='add'>+	int err;</div><div class='add'>+</div><div class='add'>+	if (req-&gt;cryptlen &lt; BLOCKCIPHER_BLOCK_SIZE)</div><div class='add'>+		return -EINVAL;</div><div class='add'>+</div><div class='add'>+	rctx-&gt;enc = enc;</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * First hash step</div><div class='add'>+	 *	enc: P_M = P_R + H_{K_H}(T, P_L)</div><div class='add'>+	 *	dec: C_M = C_R + H_{K_H}(T, C_L)</div><div class='add'>+	 */</div><div class='add'>+	adiantum_hash_header(req);</div><div class='add'>+	err = adiantum_hash_message(req, req-&gt;src, &amp;digest);</div><div class='add'>+	if (err)</div><div class='add'>+		return err;</div><div class='add'>+	le128_add(&amp;digest, &amp;digest, &amp;rctx-&gt;header_hash);</div><div class='add'>+	scatterwalk_map_and_copy(&amp;rctx-&gt;rbuf.bignum, req-&gt;src,</div><div class='add'>+				 bulk_len, BLOCKCIPHER_BLOCK_SIZE, 0);</div><div class='add'>+	le128_add(&amp;rctx-&gt;rbuf.bignum, &amp;rctx-&gt;rbuf.bignum, &amp;digest);</div><div class='add'>+</div><div class='add'>+	/* If encrypting, encrypt P_M with the block cipher to get C_M */</div><div class='add'>+	if (enc)</div><div class='add'>+		crypto_cipher_encrypt_one(tctx-&gt;blockcipher, rctx-&gt;rbuf.bytes,</div><div class='add'>+					  rctx-&gt;rbuf.bytes);</div><div class='add'>+</div><div class='add'>+	/* Initialize the rest of the XChaCha IV (first part is C_M) */</div><div class='add'>+	BUILD_BUG_ON(BLOCKCIPHER_BLOCK_SIZE != 16);</div><div class='add'>+	BUILD_BUG_ON(XCHACHA_IV_SIZE != 32);	/* nonce || stream position */</div><div class='add'>+	rctx-&gt;rbuf.words[4] = cpu_to_le32(1);</div><div class='add'>+	rctx-&gt;rbuf.words[5] = 0;</div><div class='add'>+	rctx-&gt;rbuf.words[6] = 0;</div><div class='add'>+	rctx-&gt;rbuf.words[7] = 0;</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * XChaCha needs to be done on all the data except the last 16 bytes;</div><div class='add'>+	 * for disk encryption that usually means 4080 or 496 bytes.  But ChaCha</div><div class='add'>+	 * implementations tend to be most efficient when passed a whole number</div><div class='add'>+	 * of 64-byte ChaCha blocks, or sometimes even a multiple of 256 bytes.</div><div class='add'>+	 * And here it doesn't matter whether the last 16 bytes are written to,</div><div class='add'>+	 * as the second hash step will overwrite them.  Thus, round the XChaCha</div><div class='add'>+	 * length up to the next 64-byte boundary if possible.</div><div class='add'>+	 */</div><div class='add'>+	stream_len = bulk_len;</div><div class='add'>+	if (round_up(stream_len, CHACHA_BLOCK_SIZE) &lt;= req-&gt;cryptlen)</div><div class='add'>+		stream_len = round_up(stream_len, CHACHA_BLOCK_SIZE);</div><div class='add'>+</div><div class='add'>+	skcipher_request_set_tfm(&amp;rctx-&gt;u.streamcipher_req, tctx-&gt;streamcipher);</div><div class='add'>+	skcipher_request_set_crypt(&amp;rctx-&gt;u.streamcipher_req, req-&gt;src,</div><div class='add'>+				   req-&gt;dst, stream_len, &amp;rctx-&gt;rbuf);</div><div class='add'>+	skcipher_request_set_callback(&amp;rctx-&gt;u.streamcipher_req,</div><div class='add'>+				      req-&gt;base.flags,</div><div class='add'>+				      adiantum_streamcipher_done, req);</div><div class='add'>+	return crypto_skcipher_encrypt(&amp;rctx-&gt;u.streamcipher_req) ?:</div><div class='add'>+		adiantum_finish(req);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static int adiantum_encrypt(struct skcipher_request *req)</div><div class='add'>+{</div><div class='add'>+	return adiantum_crypt(req, true);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static int adiantum_decrypt(struct skcipher_request *req)</div><div class='add'>+{</div><div class='add'>+	return adiantum_crypt(req, false);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static int adiantum_init_tfm(struct crypto_skcipher *tfm)</div><div class='add'>+{</div><div class='add'>+	struct skcipher_instance *inst = skcipher_alg_instance(tfm);</div><div class='add'>+	struct adiantum_instance_ctx *ictx = skcipher_instance_ctx(inst);</div><div class='add'>+	struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+	struct crypto_skcipher *streamcipher;</div><div class='add'>+	struct crypto_cipher *blockcipher;</div><div class='add'>+	struct crypto_shash *hash;</div><div class='add'>+	unsigned int subreq_size;</div><div class='add'>+	int err;</div><div class='add'>+</div><div class='add'>+	streamcipher = crypto_spawn_skcipher(&amp;ictx-&gt;streamcipher_spawn);</div><div class='add'>+	if (IS_ERR(streamcipher))</div><div class='add'>+		return PTR_ERR(streamcipher);</div><div class='add'>+</div><div class='add'>+	blockcipher = crypto_spawn_cipher(&amp;ictx-&gt;blockcipher_spawn);</div><div class='add'>+	if (IS_ERR(blockcipher)) {</div><div class='add'>+		err = PTR_ERR(blockcipher);</div><div class='add'>+		goto err_free_streamcipher;</div><div class='add'>+	}</div><div class='add'>+</div><div class='add'>+	hash = crypto_spawn_shash(&amp;ictx-&gt;hash_spawn);</div><div class='add'>+	if (IS_ERR(hash)) {</div><div class='add'>+		err = PTR_ERR(hash);</div><div class='add'>+		goto err_free_blockcipher;</div><div class='add'>+	}</div><div class='add'>+</div><div class='add'>+	tctx-&gt;streamcipher = streamcipher;</div><div class='add'>+	tctx-&gt;blockcipher = blockcipher;</div><div class='add'>+	tctx-&gt;hash = hash;</div><div class='add'>+</div><div class='add'>+	BUILD_BUG_ON(offsetofend(struct adiantum_request_ctx, u) !=</div><div class='add'>+		     sizeof(struct adiantum_request_ctx));</div><div class='add'>+	subreq_size = max(FIELD_SIZEOF(struct adiantum_request_ctx,</div><div class='add'>+				       u.hash_desc) +</div><div class='add'>+			  crypto_shash_descsize(hash),</div><div class='add'>+			  FIELD_SIZEOF(struct adiantum_request_ctx,</div><div class='add'>+				       u.streamcipher_req) +</div><div class='add'>+			  crypto_skcipher_reqsize(streamcipher));</div><div class='add'>+</div><div class='add'>+	crypto_skcipher_set_reqsize(tfm,</div><div class='add'>+				    offsetof(struct adiantum_request_ctx, u) +</div><div class='add'>+				    subreq_size);</div><div class='add'>+	return 0;</div><div class='add'>+</div><div class='add'>+err_free_blockcipher:</div><div class='add'>+	crypto_free_cipher(blockcipher);</div><div class='add'>+err_free_streamcipher:</div><div class='add'>+	crypto_free_skcipher(streamcipher);</div><div class='add'>+	return err;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static void adiantum_exit_tfm(struct crypto_skcipher *tfm)</div><div class='add'>+{</div><div class='add'>+	struct adiantum_tfm_ctx *tctx = crypto_skcipher_ctx(tfm);</div><div class='add'>+</div><div class='add'>+	crypto_free_skcipher(tctx-&gt;streamcipher);</div><div class='add'>+	crypto_free_cipher(tctx-&gt;blockcipher);</div><div class='add'>+	crypto_free_shash(tctx-&gt;hash);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static void adiantum_free_instance(struct skcipher_instance *inst)</div><div class='add'>+{</div><div class='add'>+	struct adiantum_instance_ctx *ictx = skcipher_instance_ctx(inst);</div><div class='add'>+</div><div class='add'>+	crypto_drop_skcipher(&amp;ictx-&gt;streamcipher_spawn);</div><div class='add'>+	crypto_drop_spawn(&amp;ictx-&gt;blockcipher_spawn);</div><div class='add'>+	crypto_drop_shash(&amp;ictx-&gt;hash_spawn);</div><div class='add'>+	kfree(inst);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/*</div><div class='add'>+ * Check for a supported set of inner algorithms.</div><div class='add'>+ * See the comment at the beginning of this file.</div><div class='add'>+ */</div><div class='add'>+static bool adiantum_supported_algorithms(struct skcipher_alg *streamcipher_alg,</div><div class='add'>+					  struct crypto_alg *blockcipher_alg,</div><div class='add'>+					  struct shash_alg *hash_alg)</div><div class='add'>+{</div><div class='add'>+	if (strcmp(streamcipher_alg-&gt;base.cra_name, "xchacha12") != 0 &amp;&amp;</div><div class='add'>+	    strcmp(streamcipher_alg-&gt;base.cra_name, "xchacha20") != 0)</div><div class='add'>+		return false;</div><div class='add'>+</div><div class='add'>+	if (blockcipher_alg-&gt;cra_cipher.cia_min_keysize &gt; BLOCKCIPHER_KEY_SIZE ||</div><div class='add'>+	    blockcipher_alg-&gt;cra_cipher.cia_max_keysize &lt; BLOCKCIPHER_KEY_SIZE)</div><div class='add'>+		return false;</div><div class='add'>+	if (blockcipher_alg-&gt;cra_blocksize != BLOCKCIPHER_BLOCK_SIZE)</div><div class='add'>+		return false;</div><div class='add'>+</div><div class='add'>+	if (strcmp(hash_alg-&gt;base.cra_name, "nhpoly1305") != 0)</div><div class='add'>+		return false;</div><div class='add'>+</div><div class='add'>+	return true;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static int adiantum_create(struct crypto_template *tmpl, struct rtattr **tb)</div><div class='add'>+{</div><div class='add'>+	struct crypto_attr_type *algt;</div><div class='add'>+	const char *streamcipher_name;</div><div class='add'>+	const char *blockcipher_name;</div><div class='add'>+	const char *nhpoly1305_name;</div><div class='add'>+	struct skcipher_instance *inst;</div><div class='add'>+	struct adiantum_instance_ctx *ictx;</div><div class='add'>+	struct skcipher_alg *streamcipher_alg;</div><div class='add'>+	struct crypto_alg *blockcipher_alg;</div><div class='add'>+	struct crypto_alg *_hash_alg;</div><div class='add'>+	struct shash_alg *hash_alg;</div><div class='add'>+	int err;</div><div class='add'>+</div><div class='add'>+	algt = crypto_get_attr_type(tb);</div><div class='add'>+	if (IS_ERR(algt))</div><div class='add'>+		return PTR_ERR(algt);</div><div class='add'>+</div><div class='add'>+	if ((algt-&gt;type ^ CRYPTO_ALG_TYPE_SKCIPHER) &amp; algt-&gt;mask)</div><div class='add'>+		return -EINVAL;</div><div class='add'>+</div><div class='add'>+	streamcipher_name = crypto_attr_alg_name(tb[1]);</div><div class='add'>+	if (IS_ERR(streamcipher_name))</div><div class='add'>+		return PTR_ERR(streamcipher_name);</div><div class='add'>+</div><div class='add'>+	blockcipher_name = crypto_attr_alg_name(tb[2]);</div><div class='add'>+	if (IS_ERR(blockcipher_name))</div><div class='add'>+		return PTR_ERR(blockcipher_name);</div><div class='add'>+</div><div class='add'>+	nhpoly1305_name = crypto_attr_alg_name(tb[3]);</div><div class='add'>+	if (nhpoly1305_name == ERR_PTR(-ENOENT))</div><div class='add'>+		nhpoly1305_name = "nhpoly1305";</div><div class='add'>+	if (IS_ERR(nhpoly1305_name))</div><div class='add'>+		return PTR_ERR(nhpoly1305_name);</div><div class='add'>+</div><div class='add'>+	inst = kzalloc(sizeof(*inst) + sizeof(*ictx), GFP_KERNEL);</div><div class='add'>+	if (!inst)</div><div class='add'>+		return -ENOMEM;</div><div class='add'>+	ictx = skcipher_instance_ctx(inst);</div><div class='add'>+</div><div class='add'>+	/* Stream cipher, e.g. "xchacha12" */</div><div class='add'>+	err = crypto_grab_skcipher(&amp;ictx-&gt;streamcipher_spawn, streamcipher_name,</div><div class='add'>+				   0, crypto_requires_sync(algt-&gt;type,</div><div class='add'>+							   algt-&gt;mask));</div><div class='add'>+	if (err)</div><div class='add'>+		goto out_free_inst;</div><div class='add'>+	streamcipher_alg = crypto_spawn_skcipher_alg(&amp;ictx-&gt;streamcipher_spawn);</div><div class='add'>+</div><div class='add'>+	/* Block cipher, e.g. "aes" */</div><div class='add'>+	err = crypto_grab_spawn(&amp;ictx-&gt;blockcipher_spawn, blockcipher_name,</div><div class='add'>+				CRYPTO_ALG_TYPE_CIPHER, CRYPTO_ALG_TYPE_MASK);</div><div class='add'>+	if (err)</div><div class='add'>+		goto out_drop_streamcipher;</div><div class='add'>+	blockcipher_alg = ictx-&gt;blockcipher_spawn.alg;</div><div class='add'>+</div><div class='add'>+	/* NHPoly1305 ÎµAâU hash function */</div><div class='add'>+	_hash_alg = crypto_alg_mod_lookup(nhpoly1305_name,</div><div class='add'>+					  CRYPTO_ALG_TYPE_SHASH,</div><div class='add'>+					  CRYPTO_ALG_TYPE_MASK);</div><div class='add'>+	if (IS_ERR(_hash_alg)) {</div><div class='add'>+		err = PTR_ERR(_hash_alg);</div><div class='add'>+		goto out_drop_blockcipher;</div><div class='add'>+	}</div><div class='add'>+	hash_alg = __crypto_shash_alg(_hash_alg);</div><div class='add'>+	err = crypto_init_shash_spawn(&amp;ictx-&gt;hash_spawn, hash_alg,</div><div class='add'>+				      skcipher_crypto_instance(inst));</div><div class='add'>+	if (err) {</div><div class='add'>+		crypto_mod_put(_hash_alg);</div><div class='add'>+		goto out_drop_blockcipher;</div><div class='add'>+	}</div><div class='add'>+</div><div class='add'>+	/* Check the set of algorithms */</div><div class='add'>+	if (!adiantum_supported_algorithms(streamcipher_alg, blockcipher_alg,</div><div class='add'>+					   hash_alg)) {</div><div class='add'>+		pr_warn("Unsupported Adiantum instantiation: (%s,%s,%s)\n",</div><div class='add'>+			streamcipher_alg-&gt;base.cra_name,</div><div class='add'>+			blockcipher_alg-&gt;cra_name, hash_alg-&gt;base.cra_name);</div><div class='add'>+		err = -EINVAL;</div><div class='add'>+		goto out_drop_hash;</div><div class='add'>+	}</div><div class='add'>+</div><div class='add'>+	/* Instance fields */</div><div class='add'>+</div><div class='add'>+	err = -ENAMETOOLONG;</div><div class='add'>+	if (snprintf(inst-&gt;alg.base.cra_name, CRYPTO_MAX_ALG_NAME,</div><div class='add'>+		     "adiantum(%s,%s)", streamcipher_alg-&gt;base.cra_name,</div><div class='add'>+		     blockcipher_alg-&gt;cra_name) &gt;= CRYPTO_MAX_ALG_NAME)</div><div class='add'>+		goto out_drop_hash;</div><div class='add'>+	if (snprintf(inst-&gt;alg.base.cra_driver_name, CRYPTO_MAX_ALG_NAME,</div><div class='add'>+		     "adiantum(%s,%s,%s)",</div><div class='add'>+		     streamcipher_alg-&gt;base.cra_driver_name,</div><div class='add'>+		     blockcipher_alg-&gt;cra_driver_name,</div><div class='add'>+		     hash_alg-&gt;base.cra_driver_name) &gt;= CRYPTO_MAX_ALG_NAME)</div><div class='add'>+		goto out_drop_hash;</div><div class='add'>+</div><div class='add'>+	inst-&gt;alg.base.cra_blocksize = BLOCKCIPHER_BLOCK_SIZE;</div><div class='add'>+	inst-&gt;alg.base.cra_ctxsize = sizeof(struct adiantum_tfm_ctx);</div><div class='add'>+	inst-&gt;alg.base.cra_alignmask = streamcipher_alg-&gt;base.cra_alignmask |</div><div class='add'>+				       hash_alg-&gt;base.cra_alignmask;</div><div class='add'>+	/*</div><div class='add'>+	 * The block cipher is only invoked once per message, so for long</div><div class='add'>+	 * messages (e.g. sectors for disk encryption) its performance doesn't</div><div class='add'>+	 * matter as much as that of the stream cipher and hash function.  Thus,</div><div class='add'>+	 * weigh the block cipher's -&gt;cra_priority less.</div><div class='add'>+	 */</div><div class='add'>+	inst-&gt;alg.base.cra_priority = (4 * streamcipher_alg-&gt;base.cra_priority +</div><div class='add'>+				       2 * hash_alg-&gt;base.cra_priority +</div><div class='add'>+				       blockcipher_alg-&gt;cra_priority) / 7;</div><div class='add'>+</div><div class='add'>+	inst-&gt;alg.setkey = adiantum_setkey;</div><div class='add'>+	inst-&gt;alg.encrypt = adiantum_encrypt;</div><div class='add'>+	inst-&gt;alg.decrypt = adiantum_decrypt;</div><div class='add'>+	inst-&gt;alg.init = adiantum_init_tfm;</div><div class='add'>+	inst-&gt;alg.exit = adiantum_exit_tfm;</div><div class='add'>+	inst-&gt;alg.min_keysize = crypto_skcipher_alg_min_keysize(streamcipher_alg);</div><div class='add'>+	inst-&gt;alg.max_keysize = crypto_skcipher_alg_max_keysize(streamcipher_alg);</div><div class='add'>+	inst-&gt;alg.ivsize = TWEAK_SIZE;</div><div class='add'>+</div><div class='add'>+	inst-&gt;free = adiantum_free_instance;</div><div class='add'>+</div><div class='add'>+	err = skcipher_register_instance(tmpl, inst);</div><div class='add'>+	if (err)</div><div class='add'>+		goto out_drop_hash;</div><div class='add'>+</div><div class='add'>+	return 0;</div><div class='add'>+</div><div class='add'>+out_drop_hash:</div><div class='add'>+	crypto_drop_shash(&amp;ictx-&gt;hash_spawn);</div><div class='add'>+out_drop_blockcipher:</div><div class='add'>+	crypto_drop_spawn(&amp;ictx-&gt;blockcipher_spawn);</div><div class='add'>+out_drop_streamcipher:</div><div class='add'>+	crypto_drop_skcipher(&amp;ictx-&gt;streamcipher_spawn);</div><div class='add'>+out_free_inst:</div><div class='add'>+	kfree(inst);</div><div class='add'>+	return err;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+/* adiantum(streamcipher_name, blockcipher_name [, nhpoly1305_name]) */</div><div class='add'>+static struct crypto_template adiantum_tmpl = {</div><div class='add'>+	.name = "adiantum",</div><div class='add'>+	.create = adiantum_create,</div><div class='add'>+	.module = THIS_MODULE,</div><div class='add'>+};</div><div class='add'>+</div><div class='add'>+static int __init adiantum_module_init(void)</div><div class='add'>+{</div><div class='add'>+	return crypto_register_template(&amp;adiantum_tmpl);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+static void __exit adiantum_module_exit(void)</div><div class='add'>+{</div><div class='add'>+	crypto_unregister_template(&amp;adiantum_tmpl);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+module_init(adiantum_module_init);</div><div class='add'>+module_exit(adiantum_module_exit);</div><div class='add'>+</div><div class='add'>+MODULE_DESCRIPTION("Adiantum length-preserving encryption mode");</div><div class='add'>+MODULE_LICENSE("GPL v2");</div><div class='add'>+MODULE_AUTHOR("Eric Biggers &lt;ebiggers@google.com&gt;");</div><div class='add'>+MODULE_ALIAS_CRYPTO("adiantum");</div><div class='head'>diff --git a/crypto/tcrypt.c b/crypto/tcrypt.c<br/>index 5fb120474902..0590a9204562 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/tcrypt.c?id=16aae3595a9d41c97d983889b341c455779c2ecf'>crypto/tcrypt.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/tcrypt.c?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/tcrypt.c</a></div><div class='hunk'>@@ -2320,6 +2320,18 @@ static int do_test(const char *alg, u32 type, u32 mask, int m, u32 num_mb)</div><div class='ctx'> 		test_cipher_speed("ctr(sm4)", DECRYPT, sec, NULL, 0,</div><div class='ctx'> 				speed_template_16);</div><div class='ctx'> 		break;</div><div class='add'>+</div><div class='add'>+	case 219:</div><div class='add'>+		test_cipher_speed("adiantum(xchacha12,aes)", ENCRYPT, sec, NULL,</div><div class='add'>+				  0, speed_template_32);</div><div class='add'>+		test_cipher_speed("adiantum(xchacha12,aes)", DECRYPT, sec, NULL,</div><div class='add'>+				  0, speed_template_32);</div><div class='add'>+		test_cipher_speed("adiantum(xchacha20,aes)", ENCRYPT, sec, NULL,</div><div class='add'>+				  0, speed_template_32);</div><div class='add'>+		test_cipher_speed("adiantum(xchacha20,aes)", DECRYPT, sec, NULL,</div><div class='add'>+				  0, speed_template_32);</div><div class='add'>+		break;</div><div class='add'>+</div><div class='ctx'> 	case 300:</div><div class='ctx'> 		if (alg) {</div><div class='ctx'> 			test_hash_speed(alg, sec, generic_hash_speed_template);</div><div class='head'>diff --git a/crypto/testmgr.c b/crypto/testmgr.c<br/>index 665911c24786..0f684a414acb 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/testmgr.c?id=16aae3595a9d41c97d983889b341c455779c2ecf'>crypto/testmgr.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/testmgr.c?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/testmgr.c</a></div><div class='hunk'>@@ -2404,6 +2404,18 @@ static int alg_test_null(const struct alg_test_desc *desc,</div><div class='ctx'> /* Please keep this list sorted by algorithm name. */</div><div class='ctx'> static const struct alg_test_desc alg_test_descs[] = {</div><div class='ctx'> 	{</div><div class='add'>+		.alg = "adiantum(xchacha12,aes)",</div><div class='add'>+		.test = alg_test_skcipher,</div><div class='add'>+		.suite = {</div><div class='add'>+			.cipher = __VECS(adiantum_xchacha12_aes_tv_template)</div><div class='add'>+		},</div><div class='add'>+	}, {</div><div class='add'>+		.alg = "adiantum(xchacha20,aes)",</div><div class='add'>+		.test = alg_test_skcipher,</div><div class='add'>+		.suite = {</div><div class='add'>+			.cipher = __VECS(adiantum_xchacha20_aes_tv_template)</div><div class='add'>+		},</div><div class='add'>+	}, {</div><div class='ctx'> 		.alg = "aegis128",</div><div class='ctx'> 		.test = alg_test_aead,</div><div class='ctx'> 		.suite = {</div><div class='head'>diff --git a/crypto/testmgr.h b/crypto/testmgr.h<br/>index 50ea1f2705c7..e7e56a8febbc 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/testmgr.h?id=16aae3595a9d41c97d983889b341c455779c2ecf'>crypto/testmgr.h</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/torvalds/linux.git/tree/crypto/testmgr.h?id=059c2a4d8e164dccc3078e49e7f286023b019a98'>crypto/testmgr.h</a></div><div class='hunk'>@@ -33381,6 +33381,467 @@ static const struct cipher_testvec xchacha12_tv_template[] = {</div><div class='ctx'> 	},</div><div class='ctx'> };</div><div class='ctx'> </div><div class='add'>+/* Adiantum test vectors from https://github.com/google/adiantum */</div><div class='add'>+static const struct cipher_testvec adiantum_xchacha12_aes_tv_template[] = {</div><div class='add'>+	{</div><div class='add'>+		.key	= "\x9e\xeb\xb2\x49\x3c\x1c\xf5\xf4"</div><div class='add'>+			  "\x6a\x99\xc2\xc4\xdf\xb1\xf4\xdd"</div><div class='add'>+			  "\x75\x20\x57\xea\x2c\x4f\xcd\xb2"</div><div class='add'>+			  "\xa5\x3d\x7b\x49\x1e\xab\xfd\x0f",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\xdf\x63\xd4\xab\xd2\x49\xf3\xd8"</div><div class='add'>+			  "\x33\x81\x37\x60\x7d\xfa\x73\x08"</div><div class='add'>+			  "\xd8\x49\x6d\x80\xe8\x2f\x62\x54"</div><div class='add'>+			  "\xeb\x0e\xa9\x39\x5b\x45\x7f\x8a",</div><div class='add'>+		.ptext	= "\x67\xc9\xf2\x30\x84\x41\x8e\x43"</div><div class='add'>+			  "\xfb\xf3\xb3\x3e\x79\x36\x7f\xe8",</div><div class='add'>+		.ctext	= "\x6d\x32\x86\x18\x67\x86\x0f\x3f"</div><div class='add'>+			  "\x96\x7c\x9d\x28\x0d\x53\xec\x9f",</div><div class='add'>+		.len	= 16,</div><div class='add'>+		.also_non_np = 1,</div><div class='add'>+		.np	= 2,</div><div class='add'>+		.tap	= { 14, 2 },</div><div class='add'>+	}, {</div><div class='add'>+		.key	= "\x36\x2b\x57\x97\xf8\x5d\xcd\x99"</div><div class='add'>+			  "\x5f\x1a\x5a\x44\x1d\x92\x0f\x27"</div><div class='add'>+			  "\xcc\x16\xd7\x2b\x85\x63\x99\xd3"</div><div class='add'>+			  "\xba\x96\xa1\xdb\xd2\x60\x68\xda",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\xef\x58\x69\xb1\x2c\x5e\x9a\x47"</div><div class='add'>+			  "\x24\xc1\xb1\x69\xe1\x12\x93\x8f"</div><div class='add'>+			  "\x43\x3d\x6d\x00\xdb\x5e\xd8\xd9"</div><div class='add'>+			  "\x12\x9a\xfe\xd9\xff\x2d\xaa\xc4",</div><div class='add'>+		.ptext	= "\x5e\xa8\x68\x19\x85\x98\x12\x23"</div><div class='add'>+			  "\x26\x0a\xcc\xdb\x0a\x04\xb9\xdf"</div><div class='add'>+			  "\x4d\xb3\x48\x7b\xb0\xe3\xc8\x19"</div><div class='add'>+			  "\x43\x5a\x46\x06\x94\x2d\xf2",</div><div class='add'>+		.ctext	= "\xc7\xc6\xf1\x73\x8f\xc4\xff\x4a"</div><div class='add'>+			  "\x39\xbe\x78\xbe\x8d\x28\xc8\x89"</div><div class='add'>+			  "\x46\x63\xe7\x0c\x7d\x87\xe8\x4e"</div><div class='add'>+			  "\xc9\x18\x7b\xbe\x18\x60\x50",</div><div class='add'>+		.len	= 31,</div><div class='add'>+	}, {</div><div class='add'>+		.key	= "\xa5\x28\x24\x34\x1a\x3c\xd8\xf7"</div><div class='add'>+			  "\x05\x91\x8f\xee\x85\x1f\x35\x7f"</div><div class='add'>+			  "\x80\x3d\xfc\x9b\x94\xf6\xfc\x9e"</div><div class='add'>+			  "\x19\x09\x00\xa9\x04\x31\x4f\x11",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\xa1\xba\x49\x95\xff\x34\x6d\xb8"</div><div class='add'>+			  "\xcd\x87\x5d\x5e\xfd\xea\x85\xdb"</div><div class='add'>+			  "\x8a\x7b\x5e\xb2\x5d\x57\xdd\x62"</div><div class='add'>+			  "\xac\xa9\x8c\x41\x42\x94\x75\xb7",</div><div class='add'>+		.ptext	= "\x69\xb4\xe8\x8c\x37\xe8\x67\x82"</div><div class='add'>+			  "\xf1\xec\x5d\x04\xe5\x14\x91\x13"</div><div class='add'>+			  "\xdf\xf2\x87\x1b\x69\x81\x1d\x71"</div><div class='add'>+			  "\x70\x9e\x9c\x3b\xde\x49\x70\x11"</div><div class='add'>+			  "\xa0\xa3\xdb\x0d\x54\x4f\x66\x69"</div><div class='add'>+			  "\xd7\xdb\x80\xa7\x70\x92\x68\xce"</div><div class='add'>+			  "\x81\x04\x2c\xc6\xab\xae\xe5\x60"</div><div class='add'>+			  "\x15\xe9\x6f\xef\xaa\x8f\xa7\xa7"</div><div class='add'>+			  "\x63\x8f\xf2\xf0\x77\xf1\xa8\xea"</div><div class='add'>+			  "\xe1\xb7\x1f\x9e\xab\x9e\x4b\x3f"</div><div class='add'>+			  "\x07\x87\x5b\x6f\xcd\xa8\xaf\xb9"</div><div class='add'>+			  "\xfa\x70\x0b\x52\xb8\xa8\xa7\x9e"</div><div class='add'>+			  "\x07\x5f\xa6\x0e\xb3\x9b\x79\x13"</div><div class='add'>+			  "\x79\xc3\x3e\x8d\x1c\x2c\x68\xc8"</div><div class='add'>+			  "\x51\x1d\x3c\x7b\x7d\x79\x77\x2a"</div><div class='add'>+			  "\x56\x65\xc5\x54\x23\x28\xb0\x03",</div><div class='add'>+		.ctext	= "\x9e\x16\xab\xed\x4b\xa7\x42\x5a"</div><div class='add'>+			  "\xc6\xfb\x4e\x76\xff\xbe\x03\xa0"</div><div class='add'>+			  "\x0f\xe3\xad\xba\xe4\x98\x2b\x0e"</div><div class='add'>+			  "\x21\x48\xa0\xb8\x65\x48\x27\x48"</div><div class='add'>+			  "\x84\x54\x54\xb2\x9a\x94\x7b\xe6"</div><div class='add'>+			  "\x4b\x29\xe9\xcf\x05\x91\x80\x1a"</div><div class='add'>+			  "\x3a\xf3\x41\x96\x85\x1d\x9f\x74"</div><div class='add'>+			  "\x51\x56\x63\xfa\x7c\x28\x85\x49"</div><div class='add'>+			  "\xf7\x2f\xf9\xf2\x18\x46\xf5\x33"</div><div class='add'>+			  "\x80\xa3\x3c\xce\xb2\x57\x93\xf5"</div><div class='add'>+			  "\xae\xbd\xa9\xf5\x7b\x30\xc4\x93"</div><div class='add'>+			  "\x66\xe0\x30\x77\x16\xe4\xa0\x31"</div><div class='add'>+			  "\xba\x70\xbc\x68\x13\xf5\xb0\x9a"</div><div class='add'>+			  "\xc1\xfc\x7e\xfe\x55\x80\x5c\x48"</div><div class='add'>+			  "\x74\xa6\xaa\xa3\xac\xdc\xc2\xf5"</div><div class='add'>+			  "\x8d\xde\x34\x86\x78\x60\x75\x8d",</div><div class='add'>+		.len	= 128,</div><div class='add'>+		.also_non_np = 1,</div><div class='add'>+		.np	= 4,</div><div class='add'>+		.tap	= { 104, 16, 4, 4 },</div><div class='add'>+	}, {</div><div class='add'>+		.key	= "\xd3\x81\x72\x18\x23\xff\x6f\x4a"</div><div class='add'>+			  "\x25\x74\x29\x0d\x51\x8a\x0e\x13"</div><div class='add'>+			  "\xc1\x53\x5d\x30\x8d\xee\x75\x0d"</div><div class='add'>+			  "\x14\xd6\x69\xc9\x15\xa9\x0c\x60",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\x65\x9b\xd4\xa8\x7d\x29\x1d\xf4"</div><div class='add'>+			  "\xc4\xd6\x9b\x6a\x28\xab\x64\xe2"</div><div class='add'>+			  "\x62\x81\x97\xc5\x81\xaa\xf9\x44"</div><div class='add'>+			  "\xc1\x72\x59\x82\xaf\x16\xc8\x2c",</div><div class='add'>+		.ptext	= "\xc7\x6b\x52\x6a\x10\xf0\xcc\x09"</div><div class='add'>+			  "\xc1\x12\x1d\x6d\x21\xa6\x78\xf5"</div><div class='add'>+			  "\x05\xa3\x69\x60\x91\x36\x98\x57"</div><div class='add'>+			  "\xba\x0c\x14\xcc\xf3\x2d\x73\x03"</div><div class='add'>+			  "\xc6\xb2\x5f\xc8\x16\x27\x37\x5d"</div><div class='add'>+			  "\xd0\x0b\x87\xb2\x50\x94\x7b\x58"</div><div class='add'>+			  "\x04\xf4\xe0\x7f\x6e\x57\x8e\xc9"</div><div class='add'>+			  "\x41\x84\xc1\xb1\x7e\x4b\x91\x12"</div><div class='add'>+			  "\x3a\x8b\x5d\x50\x82\x7b\xcb\xd9"</div><div class='add'>+			  "\x9a\xd9\x4e\x18\x06\x23\x9e\xd4"</div><div class='add'>+			  "\xa5\x20\x98\xef\xb5\xda\xe5\xc0"</div><div class='add'>+			  "\x8a\x6a\x83\x77\x15\x84\x1e\xae"</div><div class='add'>+			  "\x78\x94\x9d\xdf\xb7\xd1\xea\x67"</div><div class='add'>+			  "\xaa\xb0\x14\x15\xfa\x67\x21\x84"</div><div class='add'>+			  "\xd3\x41\x2a\xce\xba\x4b\x4a\xe8"</div><div class='add'>+			  "\x95\x62\xa9\x55\xf0\x80\xad\xbd"</div><div class='add'>+			  "\xab\xaf\xdd\x4f\xa5\x7c\x13\x36"</div><div class='add'>+			  "\xed\x5e\x4f\x72\xad\x4b\xf1\xd0"</div><div class='add'>+			  "\x88\x4e\xec\x2c\x88\x10\x5e\xea"</div><div class='add'>+			  "\x12\xc0\x16\x01\x29\xa3\xa0\x55"</div><div class='add'>+			  "\xaa\x68\xf3\xe9\x9d\x3b\x0d\x3b"</div><div class='add'>+			  "\x6d\xec\xf8\xa0\x2d\xf0\x90\x8d"</div><div class='add'>+			  "\x1c\xe2\x88\xd4\x24\x71\xf9\xb3"</div><div class='add'>+			  "\xc1\x9f\xc5\xd6\x76\x70\xc5\x2e"</div><div class='add'>+			  "\x9c\xac\xdb\x90\xbd\x83\x72\xba"</div><div class='add'>+			  "\x6e\xb5\xa5\x53\x83\xa9\xa5\xbf"</div><div class='add'>+			  "\x7d\x06\x0e\x3c\x2a\xd2\x04\xb5"</div><div class='add'>+			  "\x1e\x19\x38\x09\x16\xd2\x82\x1f"</div><div class='add'>+			  "\x75\x18\x56\xb8\x96\x0b\xa6\xf9"</div><div class='add'>+			  "\xcf\x62\xd9\x32\x5d\xa9\xd7\x1d"</div><div class='add'>+			  "\xec\xe4\xdf\x1b\xbe\xf1\x36\xee"</div><div class='add'>+			  "\xe3\x7b\xb5\x2f\xee\xf8\x53\x3d"</div><div class='add'>+			  "\x6a\xb7\x70\xa9\xfc\x9c\x57\x25"</div><div class='add'>+			  "\xf2\x89\x10\xd3\xb8\xa8\x8c\x30"</div><div class='add'>+			  "\xae\x23\x4f\x0e\x13\x66\x4f\xe1"</div><div class='add'>+			  "\xb6\xc0\xe4\xf8\xef\x93\xbd\x6e"</div><div class='add'>+			  "\x15\x85\x6b\xe3\x60\x81\x1d\x68"</div><div class='add'>+			  "\xd7\x31\x87\x89\x09\xab\xd5\x96"</div><div class='add'>+			  "\x1d\xf3\x6d\x67\x80\xca\x07\x31"</div><div class='add'>+			  "\x5d\xa7\xe4\xfb\x3e\xf2\x9b\x33"</div><div class='add'>+			  "\x52\x18\xc8\x30\xfe\x2d\xca\x1e"</div><div class='add'>+			  "\x79\x92\x7a\x60\x5c\xb6\x58\x87"</div><div class='add'>+			  "\xa4\x36\xa2\x67\x92\x8b\xa4\xb7"</div><div class='add'>+			  "\xf1\x86\xdf\xdc\xc0\x7e\x8f\x63"</div><div class='add'>+			  "\xd2\xa2\xdc\x78\xeb\x4f\xd8\x96"</div><div class='add'>+			  "\x47\xca\xb8\x91\xf9\xf7\x94\x21"</div><div class='add'>+			  "\x5f\x9a\x9f\x5b\xb8\x40\x41\x4b"</div><div class='add'>+			  "\x66\x69\x6a\x72\xd0\xcb\x70\xb7"</div><div class='add'>+			  "\x93\xb5\x37\x96\x05\x37\x4f\xe5"</div><div class='add'>+			  "\x8c\xa7\x5a\x4e\x8b\xb7\x84\xea"</div><div class='add'>+			  "\xc7\xfc\x19\x6e\x1f\x5a\xa1\xac"</div><div class='add'>+			  "\x18\x7d\x52\x3b\xb3\x34\x62\x99"</div><div class='add'>+			  "\xe4\x9e\x31\x04\x3f\xc0\x8d\x84"</div><div class='add'>+			  "\x17\x7c\x25\x48\x52\x67\x11\x27"</div><div class='add'>+			  "\x67\xbb\x5a\x85\xca\x56\xb2\x5c"</div><div class='add'>+			  "\xe6\xec\xd5\x96\x3d\x15\xfc\xfb"</div><div class='add'>+			  "\x22\x25\xf4\x13\xe5\x93\x4b\x9a"</div><div class='add'>+			  "\x77\xf1\x52\x18\xfa\x16\x5e\x49"</div><div class='add'>+			  "\x03\x45\xa8\x08\xfa\xb3\x41\x92"</div><div class='add'>+			  "\x79\x50\x33\xca\xd0\xd7\x42\x55"</div><div class='add'>+			  "\xc3\x9a\x0c\x4e\xd9\xa4\x3c\x86"</div><div class='add'>+			  "\x80\x9f\x53\xd1\xa4\x2e\xd1\xbc"</div><div class='add'>+			  "\xf1\x54\x6e\x93\xa4\x65\x99\x8e"</div><div class='add'>+			  "\xdf\x29\xc0\x64\x63\x07\xbb\xea",</div><div class='add'>+		.ctext	= "\x15\x97\xd0\x86\x18\x03\x9c\x51"</div><div class='add'>+			  "\xc5\x11\x36\x62\x13\x92\xe6\x73"</div><div class='add'>+			  "\x29\x79\xde\xa1\x00\x3e\x08\x64"</div><div class='add'>+			  "\x17\x1a\xbc\xd5\xfe\x33\x0e\x0c"</div><div class='add'>+			  "\x7c\x94\xa7\xc6\x3c\xbe\xac\xa2"</div><div class='add'>+			  "\x89\xe6\xbc\xdf\x0c\x33\x27\x42"</div><div class='add'>+			  "\x46\x73\x2f\xba\x4e\xa6\x46\x8f"</div><div class='add'>+			  "\xe4\xee\x39\x63\x42\x65\xa3\x88"</div><div class='add'>+			  "\x7a\xad\x33\x23\xa9\xa7\x20\x7f"</div><div class='add'>+			  "\x0b\xe6\x6a\xc3\x60\xda\x9e\xb4"</div><div class='add'>+			  "\xd6\x07\x8a\x77\x26\xd1\xab\x44"</div><div class='add'>+			  "\x99\x55\x03\x5e\xed\x8d\x7b\xbd"</div><div class='add'>+			  "\xc8\x21\xb7\x21\x30\x3f\xc0\xb5"</div><div class='add'>+			  "\xc8\xec\x6c\x23\xa6\xa3\x6d\xf1"</div><div class='add'>+			  "\x30\x0a\xd0\xa6\xa9\x28\x69\xae"</div><div class='add'>+			  "\x2a\xe6\x54\xac\x82\x9d\x6a\x95"</div><div class='add'>+			  "\x6f\x06\x44\xc5\x5a\x77\x6e\xec"</div><div class='add'>+			  "\xf8\xf8\x63\xb2\xe6\xaa\xbd\x8e"</div><div class='add'>+			  "\x0e\x8a\x62\x00\x03\xc8\x84\xdd"</div><div class='add'>+			  "\x47\x4a\xc3\x55\xba\xb7\xe7\xdf"</div><div class='add'>+			  "\x08\xbf\x62\xf5\xe8\xbc\xb6\x11"</div><div class='add'>+			  "\xe4\xcb\xd0\x66\x74\x32\xcf\xd4"</div><div class='add'>+			  "\xf8\x51\x80\x39\x14\x05\x12\xdb"</div><div class='add'>+			  "\x87\x93\xe2\x26\x30\x9c\x3a\x21"</div><div class='add'>+			  "\xe5\xd0\x38\x57\x80\x15\xe4\x08"</div><div class='add'>+			  "\x58\x05\x49\x7d\xe6\x92\x77\x70"</div><div class='add'>+			  "\xfb\x1e\x2d\x6a\x84\x00\xc8\x68"</div><div class='add'>+			  "\xf7\x1a\xdd\xf0\x7b\x38\x1e\xd8"</div><div class='add'>+			  "\x2c\x78\x78\x61\xcf\xe3\xde\x69"</div><div class='add'>+			  "\x1f\xd5\x03\xd5\x1a\xb4\xcf\x03"</div><div class='add'>+			  "\xc8\x7a\x70\x68\x35\xb4\xf6\xbe"</div><div class='add'>+			  "\x90\x62\xb2\x28\x99\x86\xf5\x44"</div><div class='add'>+			  "\x99\xeb\x31\xcf\xca\xdf\xd0\x21"</div><div class='add'>+			  "\xd6\x60\xf7\x0f\x40\xb4\x80\xb7"</div><div class='add'>+			  "\xab\xe1\x9b\x45\xba\x66\xda\xee"</div><div class='add'>+			  "\xdd\x04\x12\x40\x98\xe1\x69\xe5"</div><div class='add'>+			  "\x2b\x9c\x59\x80\xe7\x7b\xcc\x63"</div><div class='add'>+			  "\xa6\xc0\x3a\xa9\xfe\x8a\xf9\x62"</div><div class='add'>+			  "\x11\x34\x61\x94\x35\xfe\xf2\x99"</div><div class='add'>+			  "\xfd\xee\x19\xea\x95\xb6\x12\xbf"</div><div class='add'>+			  "\x1b\xdf\x02\x1a\xcc\x3e\x7e\x65"</div><div class='add'>+			  "\x78\x74\x10\x50\x29\x63\x28\xea"</div><div class='add'>+			  "\x6b\xab\xd4\x06\x4d\x15\x24\x31"</div><div class='add'>+			  "\xc7\x0a\xc9\x16\xb6\x48\xf0\xbf"</div><div class='add'>+			  "\x49\xdb\x68\x71\x31\x8f\x87\xe2"</div><div class='add'>+			  "\x13\x05\x64\xd6\x22\x0c\xf8\x36"</div><div class='add'>+			  "\x84\x24\x3e\x69\x5e\xb8\x9e\x16"</div><div class='add'>+			  "\x73\x6c\x83\x1e\xe0\x9f\x9e\xba"</div><div class='add'>+			  "\xe5\x59\x21\x33\x1b\xa9\x26\xc2"</div><div class='add'>+			  "\xc7\xd9\x30\x73\xb6\xa6\x73\x82"</div><div class='add'>+			  "\x19\xfa\x44\x4d\x40\x8b\x69\x04"</div><div class='add'>+			  "\x94\x74\xea\x6e\xb3\x09\x47\x01"</div><div class='add'>+			  "\x2a\xb9\x78\x34\x43\x11\xed\xd6"</div><div class='add'>+			  "\x8c\x95\x65\x1b\x85\x67\xa5\x40"</div><div class='add'>+			  "\xac\x9c\x05\x4b\x57\x4a\xa9\x96"</div><div class='add'>+			  "\x0f\xdd\x4f\xa1\xe0\xcf\x6e\xc7"</div><div class='add'>+			  "\x1b\xed\xa2\xb4\x56\x8c\x09\x6e"</div><div class='add'>+			  "\xa6\x65\xd7\x55\x81\xb7\xed\x11"</div><div class='add'>+			  "\x9b\x40\x75\xa8\x6b\x56\xaf\x16"</div><div class='add'>+			  "\x8b\x3d\xf4\xcb\xfe\xd5\x1d\x3d"</div><div class='add'>+			  "\x85\xc2\xc0\xde\x43\x39\x4a\x96"</div><div class='add'>+			  "\xba\x88\x97\xc0\xd6\x00\x0e\x27"</div><div class='add'>+			  "\x21\xb0\x21\x52\xba\xa7\x37\xaa"</div><div class='add'>+			  "\xcc\xbf\x95\xa8\xf4\xd0\x91\xf6",</div><div class='add'>+		.len	= 512,</div><div class='add'>+		.also_non_np = 1,</div><div class='add'>+		.np	= 2,</div><div class='add'>+		.tap	= { 144, 368 },</div><div class='add'>+	}</div><div class='add'>+};</div><div class='add'>+</div><div class='add'>+/* Adiantum with XChaCha20 instead of XChaCha12 */</div><div class='add'>+/* Test vectors from https://github.com/google/adiantum */</div><div class='add'>+static const struct cipher_testvec adiantum_xchacha20_aes_tv_template[] = {</div><div class='add'>+	{</div><div class='add'>+		.key	= "\x9e\xeb\xb2\x49\x3c\x1c\xf5\xf4"</div><div class='add'>+			  "\x6a\x99\xc2\xc4\xdf\xb1\xf4\xdd"</div><div class='add'>+			  "\x75\x20\x57\xea\x2c\x4f\xcd\xb2"</div><div class='add'>+			  "\xa5\x3d\x7b\x49\x1e\xab\xfd\x0f",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\xdf\x63\xd4\xab\xd2\x49\xf3\xd8"</div><div class='add'>+			  "\x33\x81\x37\x60\x7d\xfa\x73\x08"</div><div class='add'>+			  "\xd8\x49\x6d\x80\xe8\x2f\x62\x54"</div><div class='add'>+			  "\xeb\x0e\xa9\x39\x5b\x45\x7f\x8a",</div><div class='add'>+		.ptext	= "\x67\xc9\xf2\x30\x84\x41\x8e\x43"</div><div class='add'>+			  "\xfb\xf3\xb3\x3e\x79\x36\x7f\xe8",</div><div class='add'>+		.ctext	= "\xf6\x78\x97\xd6\xaa\x94\x01\x27"</div><div class='add'>+			  "\x2e\x4d\x83\xe0\x6e\x64\x9a\xdf",</div><div class='add'>+		.len	= 16,</div><div class='add'>+		.also_non_np = 1,</div><div class='add'>+		.np	= 3,</div><div class='add'>+		.tap	= { 5, 2, 9 },</div><div class='add'>+	}, {</div><div class='add'>+		.key	= "\x36\x2b\x57\x97\xf8\x5d\xcd\x99"</div><div class='add'>+			  "\x5f\x1a\x5a\x44\x1d\x92\x0f\x27"</div><div class='add'>+			  "\xcc\x16\xd7\x2b\x85\x63\x99\xd3"</div><div class='add'>+			  "\xba\x96\xa1\xdb\xd2\x60\x68\xda",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\xef\x58\x69\xb1\x2c\x5e\x9a\x47"</div><div class='add'>+			  "\x24\xc1\xb1\x69\xe1\x12\x93\x8f"</div><div class='add'>+			  "\x43\x3d\x6d\x00\xdb\x5e\xd8\xd9"</div><div class='add'>+			  "\x12\x9a\xfe\xd9\xff\x2d\xaa\xc4",</div><div class='add'>+		.ptext	= "\x5e\xa8\x68\x19\x85\x98\x12\x23"</div><div class='add'>+			  "\x26\x0a\xcc\xdb\x0a\x04\xb9\xdf"</div><div class='add'>+			  "\x4d\xb3\x48\x7b\xb0\xe3\xc8\x19"</div><div class='add'>+			  "\x43\x5a\x46\x06\x94\x2d\xf2",</div><div class='add'>+		.ctext	= "\x4b\xb8\x90\x10\xdf\x7f\x64\x08"</div><div class='add'>+			  "\x0e\x14\x42\x5f\x00\x74\x09\x36"</div><div class='add'>+			  "\x57\x72\xb5\xfd\xb5\x5d\xb8\x28"</div><div class='add'>+			  "\x0c\x04\x91\x14\x91\xe9\x37",</div><div class='add'>+		.len	= 31,</div><div class='add'>+		.also_non_np = 1,</div><div class='add'>+		.np	= 2,</div><div class='add'>+		.tap	= { 16, 15 },</div><div class='add'>+	}, {</div><div class='add'>+		.key	= "\xa5\x28\x24\x34\x1a\x3c\xd8\xf7"</div><div class='add'>+			  "\x05\x91\x8f\xee\x85\x1f\x35\x7f"</div><div class='add'>+			  "\x80\x3d\xfc\x9b\x94\xf6\xfc\x9e"</div><div class='add'>+			  "\x19\x09\x00\xa9\x04\x31\x4f\x11",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\xa1\xba\x49\x95\xff\x34\x6d\xb8"</div><div class='add'>+			  "\xcd\x87\x5d\x5e\xfd\xea\x85\xdb"</div><div class='add'>+			  "\x8a\x7b\x5e\xb2\x5d\x57\xdd\x62"</div><div class='add'>+			  "\xac\xa9\x8c\x41\x42\x94\x75\xb7",</div><div class='add'>+		.ptext	= "\x69\xb4\xe8\x8c\x37\xe8\x67\x82"</div><div class='add'>+			  "\xf1\xec\x5d\x04\xe5\x14\x91\x13"</div><div class='add'>+			  "\xdf\xf2\x87\x1b\x69\x81\x1d\x71"</div><div class='add'>+			  "\x70\x9e\x9c\x3b\xde\x49\x70\x11"</div><div class='add'>+			  "\xa0\xa3\xdb\x0d\x54\x4f\x66\x69"</div><div class='add'>+			  "\xd7\xdb\x80\xa7\x70\x92\x68\xce"</div><div class='add'>+			  "\x81\x04\x2c\xc6\xab\xae\xe5\x60"</div><div class='add'>+			  "\x15\xe9\x6f\xef\xaa\x8f\xa7\xa7"</div><div class='add'>+			  "\x63\x8f\xf2\xf0\x77\xf1\xa8\xea"</div><div class='add'>+			  "\xe1\xb7\x1f\x9e\xab\x9e\x4b\x3f"</div><div class='add'>+			  "\x07\x87\x5b\x6f\xcd\xa8\xaf\xb9"</div><div class='add'>+			  "\xfa\x70\x0b\x52\xb8\xa8\xa7\x9e"</div><div class='add'>+			  "\x07\x5f\xa6\x0e\xb3\x9b\x79\x13"</div><div class='add'>+			  "\x79\xc3\x3e\x8d\x1c\x2c\x68\xc8"</div><div class='add'>+			  "\x51\x1d\x3c\x7b\x7d\x79\x77\x2a"</div><div class='add'>+			  "\x56\x65\xc5\x54\x23\x28\xb0\x03",</div><div class='add'>+		.ctext	= "\xb1\x8b\xa0\x05\x77\xa8\x4d\x59"</div><div class='add'>+			  "\x1b\x8e\x21\xfc\x3a\x49\xfa\xd4"</div><div class='add'>+			  "\xeb\x36\xf3\xc4\xdf\xdc\xae\x67"</div><div class='add'>+			  "\x07\x3f\x70\x0e\xe9\x66\xf5\x0c"</div><div class='add'>+			  "\x30\x4d\x66\xc9\xa4\x2f\x73\x9c"</div><div class='add'>+			  "\x13\xc8\x49\x44\xcc\x0a\x90\x9d"</div><div class='add'>+			  "\x7c\xdd\x19\x3f\xea\x72\x8d\x58"</div><div class='add'>+			  "\xab\xe7\x09\x2c\xec\xb5\x44\xd2"</div><div class='add'>+			  "\xca\xa6\x2d\x7a\x5c\x9c\x2b\x15"</div><div class='add'>+			  "\xec\x2a\xa6\x69\x91\xf9\xf3\x13"</div><div class='add'>+			  "\xf7\x72\xc1\xc1\x40\xd5\xe1\x94"</div><div class='add'>+			  "\xf4\x29\xa1\x3e\x25\x02\xa8\x3e"</div><div class='add'>+			  "\x94\xc1\x91\x14\xa1\x14\xcb\xbe"</div><div class='add'>+			  "\x67\x4c\xb9\x38\xfe\xa7\xaa\x32"</div><div class='add'>+			  "\x29\x62\x0d\xb2\xf6\x3c\x58\x57"</div><div class='add'>+			  "\xc1\xd5\x5a\xbb\xd6\xa6\x2a\xe5",</div><div class='add'>+		.len	= 128,</div><div class='add'>+		.also_non_np = 1,</div><div class='add'>+		.np	= 4,</div><div class='add'>+		.tap	= { 112, 7, 8, 1 },</div><div class='add'>+	}, {</div><div class='add'>+		.key	= "\xd3\x81\x72\x18\x23\xff\x6f\x4a"</div><div class='add'>+			  "\x25\x74\x29\x0d\x51\x8a\x0e\x13"</div><div class='add'>+			  "\xc1\x53\x5d\x30\x8d\xee\x75\x0d"</div><div class='add'>+			  "\x14\xd6\x69\xc9\x15\xa9\x0c\x60",</div><div class='add'>+		.klen	= 32,</div><div class='add'>+		.iv	= "\x65\x9b\xd4\xa8\x7d\x29\x1d\xf4"</div><div class='add'>+			  "\xc4\xd6\x9b\x6a\x28\xab\x64\xe2"</div><div class='add'>+			  "\x62\x81\x97\xc5\x81\xaa\xf9\x44"</div><div class='add'>+			  "\xc1\x72\x59\x82\xaf\x16\xc8\x2c",</div><div class='add'>+		.ptext	= "\xc7\x6b\x52\x6a\x10\xf0\xcc\x09"</div><div class='add'>+			  "\xc1\x12\x1d\x6d\x21\xa6\x78\xf5"</div><div class='add'>+			  "\x05\xa3\x69\x60\x91\x36\x98\x57"</div><div class='add'>+			  "\xba\x0c\x14\xcc\xf3\x2d\x73\x03"</div><div class='add'>+			  "\xc6\xb2\x5f\xc8\x16\x27\x37\x5d"</div><div class='add'>+			  "\xd0\x0b\x87\xb2\x50\x94\x7b\x58"</div><div class='add'>+			  "\x04\xf4\xe0\x7f\x6e\x57\x8e\xc9"</div><div class='add'>+			  "\x41\x84\xc1\xb1\x7e\x4b\x91\x12"</div><div class='add'>+			  "\x3a\x8b\x5d\x50\x82\x7b\xcb\xd9"</div><div class='add'>+			  "\x9a\xd9\x4e\x18\x06\x23\x9e\xd4"</div><div class='add'>+			  "\xa5\x20\x98\xef\xb5\xda\xe5\xc0"</div><div class='add'>+			  "\x8a\x6a\x83\x77\x15\x84\x1e\xae"</div><div class='add'>+			  "\x78\x94\x9d\xdf\xb7\xd1\xea\x67"</div><div class='add'>+			  "\xaa\xb0\x14\x15\xfa\x67\x21\x84"</div><div class='add'>+			  "\xd3\x41\x2a\xce\xba\x4b\x4a\xe8"</div><div class='add'>+			  "\x95\x62\xa9\x55\xf0\x80\xad\xbd"</div><div class='add'>+			  "\xab\xaf\xdd\x4f\xa5\x7c\x13\x36"</div><div class='add'>+			  "\xed\x5e\x4f\x72\xad\x4b\xf1\xd0"</div><div class='add'>+			  "\x88\x4e\xec\x2c\x88\x10\x5e\xea"</div><div class='add'>+			  "\x12\xc0\x16\x01\x29\xa3\xa0\x55"</div><div class='add'>+			  "\xaa\x68\xf3\xe9\x9d\x3b\x0d\x3b"</div><div class='add'>+			  "\x6d\xec\xf8\xa0\x2d\xf0\x90\x8d"</div><div class='add'>+			  "\x1c\xe2\x88\xd4\x24\x71\xf9\xb3"</div><div class='add'>+			  "\xc1\x9f\xc5\xd6\x76\x70\xc5\x2e"</div><div class='add'>+			  "\x9c\xac\xdb\x90\xbd\x83\x72\xba"</div><div class='add'>+			  "\x6e\xb5\xa5\x53\x83\xa9\xa5\xbf"</div><div class='add'>+			  "\x7d\x06\x0e\x3c\x2a\xd2\x04\xb5"</div><div class='add'>+			  "\x1e\x19\x38\x09\x16\xd2\x82\x1f"</div><div class='add'>+			  "\x75\x18\x56\xb8\x96\x0b\xa6\xf9"</div><div class='add'>+			  "\xcf\x62\xd9\x32\x5d\xa9\xd7\x1d"</div><div class='add'>+			  "\xec\xe4\xdf\x1b\xbe\xf1\x36\xee"</div><div class='add'>+			  "\xe3\x7b\xb5\x2f\xee\xf8\x53\x3d"</div><div class='add'>+			  "\x6a\xb7\x70\xa9\xfc\x9c\x57\x25"</div><div class='add'>+			  "\xf2\x89\x10\xd3\xb8\xa8\x8c\x30"</div><div class='add'>+			  "\xae\x23\x4f\x0e\x13\x66\x4f\xe1"</div><div class='add'>+			  "\xb6\xc0\xe4\xf8\xef\x93\xbd\x6e"</div><div class='add'>+			  "\x15\x85\x6b\xe3\x60\x81\x1d\x68"</div><div class='add'>+			  "\xd7\x31\x87\x89\x09\xab\xd5\x96"</div><div class='add'>+			  "\x1d\xf3\x6d\x67\x80\xca\x07\x31"</div><div class='add'>+			  "\x5d\xa7\xe4\xfb\x3e\xf2\x9b\x33"</div><div class='add'>+			  "\x52\x18\xc8\x30\xfe\x2d\xca\x1e"</div><div class='add'>+			  "\x79\x92\x7a\x60\x5c\xb6\x58\x87"</div><div class='add'>+			  "\xa4\x36\xa2\x67\x92\x8b\xa4\xb7"</div><div class='add'>+			  "\xf1\x86\xdf\xdc\xc0\x7e\x8f\x63"</div><div class='add'>+			  "\xd2\xa2\xdc\x78\xeb\x4f\xd8\x96"</div><div class='add'>+			  "\x47\xca\xb8\x91\xf9\xf7\x94\x21"</div><div class='add'>+			  "\x5f\x9a\x9f\x5b\xb8\x40\x41\x4b"</div><div class='add'>+			  "\x66\x69\x6a\x72\xd0\xcb\x70\xb7"</div><div class='add'>+			  "\x93\xb5\x37\x96\x05\x37\x4f\xe5"</div><div class='add'>+			  "\x8c\xa7\x5a\x4e\x8b\xb7\x84\xea"</div><div class='add'>+			  "\xc7\xfc\x19\x6e\x1f\x5a\xa1\xac"</div><div class='add'>+			  "\x18\x7d\x52\x3b\xb3\x34\x62\x99"</div><div class='add'>+			  "\xe4\x9e\x31\x04\x3f\xc0\x8d\x84"</div><div class='add'>+			  "\x17\x7c\x25\x48\x52\x67\x11\x27"</div><div class='add'>+			  "\x67\xbb\x5a\x85\xca\x56\xb2\x5c"</div><div class='add'>+			  "\xe6\xec\xd5\x96\x3d\x15\xfc\xfb"</div><div class='add'>+			  "\x22\x25\xf4\x13\xe5\x93\x4b\x9a"</div><div class='add'>+			  "\x77\xf1\x52\x18\xfa\x16\x5e\x49"</div><div class='add'>+			  "\x03\x45\xa8\x08\xfa\xb3\x41\x92"</div><div class='add'>+			  "\x79\x50\x33\xca\xd0\xd7\x42\x55"</div><div class='add'>+			  "\xc3\x9a\x0c\x4e\xd9\xa4\x3c\x86"</div><div class='add'>+			  "\x80\x9f\x53\xd1\xa4\x2e\xd1\xbc"</div><div class='add'>+			  "\xf1\x54\x6e\x93\xa4\x65\x99\x8e"</div><div class='add'>+			  "\xdf\x29\xc0\x64\x63\x07\xbb\xea",</div><div class='add'>+		.ctext	= "\xe0\x33\xf6\xe0\xb4\xa5\xdd\x2b"</div><div class='add'>+			  "\xdd\xce\xfc\x12\x1e\xfc\x2d\xf2"</div><div class='add'>+			  "\x8b\xc7\xeb\xc1\xc4\x2a\xe8\x44"</div><div class='add'>+			  "\x0f\x3d\x97\x19\x2e\x6d\xa2\x38"</div><div class='add'>+			  "\x9d\xa6\xaa\xe1\x96\xb9\x08\xe8"</div><div class='add'>+			  "\x0b\x70\x48\x5c\xed\xb5\x9b\xcb"</div><div class='add'>+			  "\x8b\x40\x88\x7e\x69\x73\xf7\x16"</div><div class='add'>+			  "\x71\xbb\x5b\xfc\xa3\x47\x5d\xa6"</div><div class='add'>+			  "\xae\x3a\x64\xc4\xe7\xb8\xa8\xe7"</div><div class='add'>+			  "\xb1\x32\x19\xdb\xe3\x01\xb8\xf0"</div><div class='add'>+			  "\xa4\x86\xb4\x4c\xc2\xde\x5c\xd2"</div><div class='add'>+			  "\x6c\x77\xd2\xe8\x18\xb7\x0a\xc9"</div><div class='add'>+			  "\x3d\x53\xb5\xc4\x5c\xf0\x8c\x06"</div><div class='add'>+			  "\xdc\x90\xe0\x74\x47\x1b\x0b\xf6"</div><div class='add'>+			  "\xd2\x71\x6b\xc4\xf1\x97\x00\x2d"</div><div class='add'>+			  "\x63\x57\x44\x1f\x8c\xf4\xe6\x9b"</div><div class='add'>+			  "\xe0\x7a\xdd\xec\x32\x73\x42\x32"</div><div class='add'>+			  "\x7f\x35\x67\x60\x0d\xcf\x10\x52"</div><div class='add'>+			  "\x61\x22\x53\x8d\x8e\xbb\x33\x76"</div><div class='add'>+			  "\x59\xd9\x10\xce\xdf\xef\xc0\x41"</div><div class='add'>+			  "\xd5\x33\x29\x6a\xda\x46\xa4\x51"</div><div class='add'>+			  "\xf0\x99\x3d\x96\x31\xdd\xb5\xcb"</div><div class='add'>+			  "\x3e\x2a\x1f\xc7\x5c\x79\xd3\xc5"</div><div class='add'>+			  "\x20\xa1\xb1\x39\x1b\xc6\x0a\x70"</div><div class='add'>+			  "\x26\x39\x95\x07\xad\x7a\xc9\x69"</div><div class='add'>+			  "\xfe\x81\xc7\x88\x08\x38\xaf\xad"</div><div class='add'>+			  "\x9e\x8d\xfb\xe8\x24\x0d\x22\xb8"</div><div class='add'>+			  "\x0e\xed\xbe\x37\x53\x7c\xa6\xc6"</div><div class='add'>+			  "\x78\x62\xec\xa3\x59\xd9\xc6\x9d"</div><div class='add'>+			  "\xb8\x0e\x69\x77\x84\x2d\x6a\x4c"</div><div class='add'>+			  "\xc5\xd9\xb2\xa0\x2b\xa8\x80\xcc"</div><div class='add'>+			  "\xe9\x1e\x9c\x5a\xc4\xa1\xb2\x37"</div><div class='add'>+			  "\x06\x9b\x30\x32\x67\xf7\xe7\xd2"</div><div class='add'>+			  "\x42\xc7\xdf\x4e\xd4\xcb\xa0\x12"</div><div class='add'>+			  "\x94\xa1\x34\x85\x93\x50\x4b\x0a"</div><div class='add'>+			  "\x3c\x7d\x49\x25\x01\x41\x6b\x96"</div><div class='add'>+			  "\xa9\x12\xbb\x0b\xc0\xd7\xd0\x93"</div><div class='add'>+			  "\x1f\x70\x38\xb8\x21\xee\xf6\xa7"</div><div class='add'>+			  "\xee\xeb\xe7\x81\xa4\x13\xb4\x87"</div><div class='add'>+			  "\xfa\xc1\xb0\xb5\x37\x8b\x74\xa2"</div><div class='add'>+			  "\x4e\xc7\xc2\xad\x3d\x62\x3f\xf8"</div><div class='add'>+			  "\x34\x42\xe5\xae\x45\x13\x63\xfe"</div><div class='add'>+			  "\xfc\x2a\x17\x46\x61\xa9\xd3\x1c"</div><div class='add'>+			  "\x4c\xaf\xf0\x09\x62\x26\x66\x1e"</div><div class='add'>+			  "\x74\xcf\xd6\x68\x3d\x7d\xd8\xb7"</div><div class='add'>+			  "\xe7\xe6\xf8\xf0\x08\x20\xf7\x47"</div><div class='add'>+			  "\x1c\x52\xaa\x0f\x3e\x21\xa3\xf2"</div><div class='add'>+			  "\xbf\x2f\x95\x16\xa8\xc8\xc8\x8c"</div><div class='add'>+			  "\x99\x0f\x5d\xfb\xfa\x2b\x58\x8a"</div><div class='add'>+			  "\x7e\xd6\x74\x02\x60\xf0\xd0\x5b"</div><div class='add'>+			  "\x65\xa8\xac\xea\x8d\x68\x46\x34"</div><div class='add'>+			  "\x26\x9d\x4f\xb1\x9a\x8e\xc0\x1a"</div><div class='add'>+			  "\xf1\xed\xc6\x7a\x83\xfd\x8a\x57"</div><div class='add'>+			  "\xf2\xe6\xe4\xba\xfc\xc6\x3c\xad"</div><div class='add'>+			  "\x5b\x19\x50\x2f\x3a\xcc\x06\x46"</div><div class='add'>+			  "\x04\x51\x3f\x91\x97\xf0\xd2\x07"</div><div class='add'>+			  "\xe7\x93\x89\x7e\xb5\x32\x0f\x03"</div><div class='add'>+			  "\xe5\x58\x9e\x74\x72\xeb\xc2\x38"</div><div class='add'>+			  "\x00\x0c\x91\x72\x69\xed\x7d\x6d"</div><div class='add'>+			  "\xc8\x71\xf0\xec\xff\x80\xd9\x1c"</div><div class='add'>+			  "\x9e\xd2\xfa\x15\xfc\x6c\x4e\xbc"</div><div class='add'>+			  "\xb1\xa6\xbd\xbd\x70\x40\xca\x20"</div><div class='add'>+			  "\xb8\x78\xd2\xa3\xc6\xf3\x79\x9c"</div><div class='add'>+			  "\xc7\x27\xe1\x6a\x29\xad\xa4\x03",</div><div class='add'>+		.len	= 512,</div><div class='add'>+	}</div><div class='add'>+};</div><div class='add'>+</div><div class='ctx'> /*</div><div class='ctx'>  * CTS (Cipher Text Stealing) mode tests</div><div class='ctx'>  */</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2-0.3.lf.el7</a> (<a href='https://git-scm.com/'>git 2.18.0</a>) at 2019-04-04 17:46:31 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>



#####EOF#####


