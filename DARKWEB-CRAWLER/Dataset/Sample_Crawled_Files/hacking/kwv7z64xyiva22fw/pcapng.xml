<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Convert PcapNG to PCAP</title>
    <meta name="description" content="Convert Pcap-NG / NTAR (.pcapng) files to the libpcap (.pcap) file format. PcapNG metadata, such as OS, application, capture filter and annotations, is also extracted and displayed." />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <meta name="keywords" content="pcap,pcapng,convert,ntar,wireshark,pcap-ng,next generation,dump,file,format,network,metadata,meta-data,extract,show,name resolution,NRB" />
    <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-36498433-1']);
          _gaq.push(['_trackPageview']);

          (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>
  </head>
  <body>
    <div class="middle" style="width: 680px;">
      <div id="pageHeader">
        <span style="align: right; float: right; vertical-align: top;">The easiest way to convert PcapNG files to PCAP format</span>
        <a href="http://pcapng.com/">
          <img src="/images/PcapNG-com_logo_331x92.png" alt="PCAPNG" />
        </a>
      </div>
      <div id="pageBody">
        <div style="margin: 20px; font-size: 12px;">
          <p>
        In <a href="http://www.wireshark.org/" rel="nofollow">Wireshark</a> 1.8 and later the default file format is
        <a href="http://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html" rel="nofollow">Pcap-NG</a> (aka NTAR).
        This format allows for more advanced features than the old <a href="http://wiki.wireshark.org/Development/LibpcapFileFormat" rel="nofollow">libpcap</a> (aka PCAP) format,
        such as multiple interface types and annotations.
      </p>
          <p>
        If you need to load a PcapNG capture file into a tool that doesn't support the PcapNG format,
        then you first need to convert the capture file to the legacy PCAP format.
        You can <a href="http://www.netresec.com/?page=CapLoader#trial">convert from PcapNG to PCAP with CapLoader</a> or the command line tool
        <a href="http://www.netresec.com/?page=Blog&amp;month=2012-12&amp;post=HowTo-handle-PcapNG-files">editcap</a>,
        but an even easier solution is to upload your PcapNG file here.
      </p>
          <p>
        Metadata available in PcapNG options (operating system, sniffer application, capture filter, frame annotations etc.)
        and name resolution blocks (cached hostname / DNS entries) is also extracted and displayed.
      </p>
        </div>
        <h2 style="margin: 20px; font-family: Lucida Sans, Tahoma, Verdana, Arial; margin-top: 40px;">Convert PcapNG to PCAP</h2>
        <img src="/images/dump-pcapng_to_dump-pcap_82x177.png" alt="pcapng2pcap" style="float: right; clear: right; margin: 20px;" />
        <form method="post" enctype="multipart/form-data" action="/">
          <fieldset style="padding: 20px; margin: 40px;">
            <legend style="color: #aaaaaa;">[SELECT PCAPNG FILE TO CONVERT]</legend>
            <table class="white">
              <tr>
                <td style="vertical-align: middle;">Select file to convert:</td>
                <td>
                  <input type="file" name="file_to_upload" />
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <input type="submit" value="Convert to PCAP" style="width: 400px;" />
                </td>
              </tr>
            </table>
            <p>
          Only first 8.00 MB will be converted
          </p>
          </fieldset>
        </form>
        <h2 style="margin: 20px; font-family: Lucida Sans, Tahoma, Verdana, Arial; margin-top: 100px;">Resources</h2>
        <div style="margin: 20px;">
          <p>
          Pcap-NG specification<br /><a href="http://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html" rel="nofollow">http://www.winpcap.org/ntar/draft/PCAP-DumpFileFormat.html</a></p>
          <p>
          Pcap-NG format mailing list<br /><a href="https://www.winpcap.org/mailman/listinfo/pcap-ng-format" rel="nofollow">https://www.winpcap.org/mailman/listinfo/pcap-ng-format</a></p>
          <p>
          Blog post on "How to handle PcapNG files"<br /><a href="http://www.netresec.com/?page=Blog&amp;month=2012-12&amp;post=HowTo-handle-PcapNG-files">http://www.netresec.com/?page=Blog&amp;month=2012-12&amp;post=HowTo-handle-PcapNG-files</a></p>
          <p>
          List of publicly available PCAP and PcapNG files on the Internet<br /><a href="http://www.netresec.com/?page=PcapFiles">http://www.netresec.com/?page=PcapFiles</a></p>
        </div>
        <h2 style="margin: 20px; font-family: Lucida Sans, Tahoma, Verdana, Arial; margin-top: 40px;">PcapNG Enabled Software</h2>
        <div style="margin: 20px;">
          <p>
            <i>The following applications have support for the PcapNG file format:</i>
          </p>
          <p>
            <b>
              <a href="http://www.wireshark.org/" rel="nofollow">Wireshark</a>
            </b>
            <br />
        Wireshark has uses the PcapNG file format as its default output format from version 1.8.
      </p>
          <p>
            <b>
              <a href="http://www.netresec.com/?page=CapLoader" title="CapLoader can read PcapNG capture files">CapLoader</a>
            </b>
            <br />
        CapLoader is a fast PCAP and PcapNG parser, which can read capture files and export a filtered subset to other tools.
        CapLoader supports exports in the old PCAP file format, which makes it an ideal tool for offline conversion from PCAP to PcapNG.
      </p>
          <p>
            <b>
              <a href="http://www.tcpdump.org" rel="nofollow">TCPDUMP</a>
            </b>
            <br />
        Tcpdump version 4.1.1 and later can handle PcapNG files (if libpcap 1.1.0 or later is installed).
      </p>
        </div>
        <h2 style="margin: 20px; font-family: Lucida Sans, Tahoma, Verdana, Arial; margin-top: 40px;">Error Messages</h2>
        <p style="margin: 20px;">
      The error messages listed below are from applications that for different reasons fail to parse PcapNG / NTAR files.
      Please note that applications that use libpcap version 1.1.0 or later should be able to handle Pcap-NG files that contain just a single data link type.
    </p>
        <div>
          <table class="white">
            <tr>
              <th>Application</th>
              <th>Error Message(s)</th>
            </tr>
            <tr>
              <td>
                <a href="http://www.qosient.com/argus/" rel="nofollow">Argus</a>
              </td>
              <td>
            argus[2784]: 28 Nov 12 12:24:20.036230 ArgusOpenInputPacketFile: pcap_open_offline: capture.pcapng, unknown packet file format
          </td>
            </tr>
            <tr>
              <td>
                <a href="http://www.bro-ids.org/" rel="nofollow">Bro</a>
              </td>
              <td>
            bro: problem with trace file dump.ntar - bad dump file format
          </td>
            </tr>
            <tr>
              <td>
                <a href="http://www.netresec.com/?page=NetworkMiner">NetworkMiner</a>
              </td>
              <td>
            Error opening pcap file: The stream is not a PCAP file. Magic number is A0D0D0A or A0D0D0A but should be A1B2C3D4.
          </td>
            </tr>
            <tr>
              <td>
                <a href="http://www.secdev.org/projects/scapy/" rel="nofollow">Scapy</a>
              </td>
              <td>
            raise Scapy_Exception("Not a pcap capture file (bad magic)")
          </td>
            </tr>
            <tr>
              <td>
                <a href="http://www.snort.org/" rel="nofollow">Snort</a>
              </td>
              <td>
              ERROR: Can't initialize DAQ pcap (-1) - bad dump file format<br />
              Fatal Error, Quitting..
          </td>
            </tr>
            <tr>
              <td>
                <a href="http://www.openinfosecfoundation.org/" rel="nofollow">Suricata</a>
              </td>
              <td>
            (source-pcap-file.c:221) &lt;Error&gt; (ReceivePcapFileThreadInit) -- [ERRCODE: SC_ERR_FOPEN(44)] - bad dump file format
          </td>
            </tr>
            <tr>
              <td>
                <a href="http://www.tcpdump.org/" rel="nofollow">tcpdump</a>
              </td>
              <td>
              tcpdump: bad dump file format
          </td>
            </tr>
            <tr>
              <td>
                <a href="https://github.com/simsong/tcpflow/wiki/tcpflow-%E2%80%94-A-tcp-ip-session-reassembler" rel="nofollow">tcpflow</a>
              </td>
              <td>
            tcpflow[5957]: bad dump file format
          </td>
            </tr>
            <tr>
              <td width="160">
                <a href="http://www.wireshark.org/" rel="nofollow">Wireshark</a> suite (capinfos, dumpcap, editcap, mergecap, tshark, etc.)
          </td>
              <td>
                <p style="margin-top: 0px;">
              Can't open or create merged.ntar: Files from that network type can't be saved in that format
            </p>
                <p>
              Can't open dump.pcapng: Success
            </p>
                <p>
              The file appears to be damaged or corrupt.<br />
              (pcapng: interface index 1 is not less than interface count 1.)
            </p>
                <p>
              The file "capture.pcapng" contains record data that TShark doesn't support.<br />
              (pcapng: multiple section header blocks not supported.)
            </p>
                <p>
              Can't open or create dump.pcap: That file format doesn't support per-packet encapsulations
            </p>
              </td>
            </tr>
            <tr>
              <td>
                <a href="https://github.com/kbandla/dpkt" rel="nofollow">dpkt</a> (python module)</td>
              <td>
                <p style="margin-top: 0px;">
Traceback (most recent call last):<br />
Â Â File "/usr/local/lib/python2.7/dist-packages/dpkt/pcap.py", line 218, in __init__<br />
Â Â Â Â raise ValueError('invalid tcpdump header')<br />
ValueError: invalid tcpdump header
          </p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div id="pageFooter">
        <span>
              This free online service is sponsored by <a href="http://www.netresec.com/">NETRESEC</a></span>
      </div>
    </div>
  </body>
</html>


#####EOF#####


